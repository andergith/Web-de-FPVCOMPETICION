<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPV COMPETICION | Web Oficial del Canal</title>
    <meta name="description" content="Web oficial del canal FPV COMPETICION - DRONES. Tutoriales de montaje, reviews honestas, simuladores y la mejor comunidad de FPV en español.">
    <!-- Meta robots para control legal -->
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook / WhatsApp -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://fpv-drones.es/">
    <meta property="og:title" content="FPV COMPETICION | No vueles el drone, SÉ el drone">
    <meta property="og:description" content="Tutoriales, builds, simuladores y la comunidad más cañera de FPV en español.">
    <!-- Usar ruta absoluta recomendada para OG images -->
    <meta property="og:image" content="https://fpv-drones.es/imagenes/social-share.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://fpv-drones.es/">
    <meta property="twitter:title" content="FPV COMPETICION | Web Oficial">
    <meta property="twitter:description" content="Tutoriales, builds, simuladores y la comunidad más cañera de FPV en español.">
    
    <!-- Structured Data (SEO) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "FPV COMPETICION",
      "url": "https://fpv-drones.es/",
      "author": {
        "@type": "Person",
        "name": "Alex"
      },
      "description": "La web oficial del canal de YouTube FPV COMPETICION - DRONES.",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://fpv-drones.es/?s={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>

    <!-- Favicon -->
    <link rel="icon" href="imagenes/logo-fpv-competicion.png" type="image/png">
    
    <!-- Tailwind CSS (Nota: En producción real, usar build step para evitar CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Configuración Tailwind -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#dc2626',
                        dark: {
                            bg: '#0f172a',
                            card: '#1e293b',
                            border: '#334155'
                        }
                    },
                    fontFamily: {
                        teko: ['Teko', 'sans-serif'],
                        inter: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts con display=swap para rendimiento -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@300;400;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    
    <!-- ESTILOS CSS -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            transition-property: color, background-color, border-color;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 300ms;
        }

        h1, h2, h3, h4, .font-teko {
            font-family: 'Teko', sans-serif;
            text-transform: uppercase;
        }

        /* Reading Progress Bar */
        #reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 4px;
            background: linear-gradient(90deg, #dc2626, #ef4444);
            z-index: 100;
            transition: width 0.1s ease-out;
        }

        /* Privacy Facade for YouTube (GDPR) */
        .video-facade {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            background-image: url('https://img.youtube.com/vi/vHc5jnxkuzg/maxresdefault.jpg');
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 20;
            transition: background-image 0.5s ease;
        }
        .play-button {
            width: 68px;
            height: 48px;
            background-color: rgba(33, 33, 33, 0.8);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        .play-button:hover { background-color: #f00; }
        .play-triangle {
            width: 0; 
            height: 0; 
            border-left: 20px solid white;
            border-top: 10px solid transparent;
            border-bottom: 10px solid transparent;
        }

        /* Section Styling */
        .section-slant { position: relative; z-index: 10; }
        .section-slant::after {
            content: '';
            position: absolute;
            left: 0; bottom: -50px; width: 100%; height: 100px;
            background: none;
            transform: skewY(-2deg);
            transform-origin: bottom left;
            z-index: -1;
        }

        .hero-bg-image {
            background-color: rgba(255, 255, 255, 0.08) !important;
            background-image: radial-gradient(circle at 12px 12px, rgba(0,0,0,0.06) 1px, transparent 1px) !important;
            background-size: 20px 20px !important;
        }
        .dark .hero-bg-image {
            background-color: rgba(15, 23, 42, 0.6) !important;
            background-image: radial-gradient(circle at 12px 12px, rgba(255,255,255,0.08) 1px, transparent 1px) !important;
            background-size: 20px 20px !important;
        }

        .component-box {
            padding: 15px; border-radius: 12px; text-align: center; font-weight: 600;
            position: relative; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); z-index: 10;
        }
        .component-box:hover { transform: translateY(-5px); border-color: #dc2626; }

        .flow-line { stroke-dasharray: 10; animation: flow 1s linear infinite; }
        @keyframes flow { from { stroke-dashoffset: 20; } to { stroke-dashoffset: 0; } }

        .aspect-w-16 {
            position: relative; padding-bottom: 56.25%; border-radius: 12px; overflow: hidden;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .aspect-w-16 iframe, .aspect-w-16 .video-facade {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        }

        .fade-in { animation: fadeIn 0.6s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background: #475569; }

        /* Modal Overlay */
        .modal-overlay { background-color: rgba(0, 0, 0, 0.7); backdrop-filter: blur(4px); }

        /* Toast */
        #toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
        .toast {
            min-width: 250px; background-color: #1e293b; color: white; padding: 16px;
            border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); border-left: 4px solid #dc2626;
            display: flex; align-items: center; justify-content: space-between;
            animation: slideIn 0.3s ease-out;
        }
        .toast.success { border-left-color: #22c55e; }
        .toast.error { border-left-color: #ef4444; }
        
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }

        #scroll-top-btn {
            position: fixed; bottom: 100px; right: 20px; z-index: 49; opacity: 0; transform: translateY(20px);
            transition: all 0.3s ease; pointer-events: none;
        }
        #scroll-top-btn.visible { opacity: 1; transform: translateY(0); pointer-events: all; }

        /* RGPD COMPLIANT COOKIE BANNER */
        #cookie-banner {
            position: fixed; bottom: 0; left: 0; right: 0;
            background-color: #0f172a; border-top: 1px solid #334155;
            padding: 1.5rem; z-index: 10000;
            transform: translateY(100%); transition: transform 0.3s ease-in-out;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.5);
        }
        #cookie-banner.show { transform: translateY(0); }
        
        /* Toggle Switch CSS for Settings */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #dc2626;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #dc2626;
        }
        
        /* Mobile Table */
        @media (max-width: 768px) {
            #couponTableBody tr { display: flex; flex-direction: column; background-color: rgba(255,255,255,0.05); margin-bottom: 1rem; border-radius: 0.5rem; padding: 1rem; border: 1px solid rgba(255,255,255,0.1); }
            #couponTableBody td { display: flex; justify-content: space-between; align-items: center; padding: 0.5rem 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
            #couponTableBody td:last-child { border-bottom: none; }
            thead { display: none; }
        }

        .skeleton {
            background: linear-gradient(90deg, rgba(255,255,255,0.05) 25%, rgba(255,255,255,0.1) 37%, rgba(255,255,255,0.05) 63%);
            background-size: 400% 100%; animation: skeleton-loading 1.4s ease infinite;
        }
        @keyframes skeleton-loading { 0% { background-position: 100% 50%; } 100% { background-position: 0 50%; } }
    </style>
</head>
<body class="antialiased scroll-smooth bg-slate-50 text-slate-900 dark:bg-dark-bg dark:text-slate-200 transition-colors duration-300">

    <!-- NEW: Reading Progress Bar -->
    <div id="reading-progress"></div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full bg-white/80 dark:bg-dark-bg/80 backdrop-blur-lg border-b border-slate-200 dark:border-slate-800 z-50 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <!-- Logo -->
                <div class="flex-shrink-0 flex items-center gap-3 cursor-pointer group" onclick="scrollToSection('hero')">
                    <span class="font-teko text-3xl tracking-wide text-slate-900 dark:text-white">FPV <span class="text-red-600">COMPETICION</span></span>
                </div>
                
                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center space-x-4">
                    <button onclick="scrollToSection('academia')" class="text-slate-600 dark:text-slate-300 hover:text-red-600 px-3 py-2 text-sm font-bold uppercase">Academia</button>
                    <button onclick="scrollToSection('equipo')" class="text-slate-600 dark:text-slate-300 hover:text-red-600 px-3 py-2 text-sm font-bold uppercase">Equipo</button>
                    <button onclick="scrollToSection('ofertas')" class="text-slate-600 dark:text-slate-300 hover:text-red-600 px-3 py-2 text-sm font-bold uppercase">Ofertas</button>
                    <button onclick="scrollToSection('builds')" class="text-slate-600 dark:text-slate-300 hover:text-red-600 px-3 py-2 text-sm font-bold uppercase">Builds</button>
                    <button onclick="scrollToSection('videos-destacados')" class="text-slate-600 dark:text-slate-300 hover:text-red-600 px-3 py-2 text-sm font-bold uppercase">Canal</button>
                    <button onclick="scrollToSection('servicios')" class="text-slate-600 dark:text-slate-300 hover:text-red-600 px-3 py-2 text-sm font-bold uppercase">Servicios</button>
                    <button onclick="scrollToSection('blog')" class="text-slate-600 dark:text-slate-300 hover:text-red-600 px-3 py-2 text-sm font-bold uppercase">Blog</button>
                    
                    <div class="h-6 w-px bg-slate-200 dark:bg-slate-700 mx-2"></div>

                    <!-- Social -->
                    <div class="flex items-center gap-3">
                        <a href="#" class="text-slate-500 hover:text-red-600" aria-label="YouTube"><i class="fab fa-youtube text-lg"></i></a>
                        <a href="#" class="text-slate-500 hover:text-pink-600" aria-label="Instagram"><i class="fab fa-instagram text-lg"></i></a>
                        <a href="#" class="text-slate-500 hover:text-blue-500" aria-label="Telegram"><i class="fab fa-telegram text-lg"></i></a>
                    </div>

                    <!-- Dark Mode -->
                    <button id="theme-toggle-desktop" aria-label="Cambiar tema" class="p-2 rounded-full bg-slate-200 dark:bg-slate-700 text-slate-800 dark:text-yellow-400 transition-colors">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:inline"></i>
                    </button>
                </div>

                <!-- Mobile Toggle -->
                <div class="flex items-center md:hidden gap-4">
                     <button id="theme-toggle-mobile" aria-label="Cambiar tema móvil" class="text-slate-800 dark:text-yellow-400">
                        <i class="fas fa-moon dark:hidden"></i>
                        <i class="fas fa-sun hidden dark:inline"></i>
                    </button>
                    <button id="mobile-menu-btn" aria-label="Menú móvil" class="text-slate-900 dark:text-white hover:text-red-600">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Panel -->
        <div id="mobile-menu" class="hidden md:hidden bg-white dark:bg-dark-card border-b border-slate-100 dark:border-slate-800">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#academia" class="block px-3 py-2 rounded-md font-bold uppercase text-slate-800 dark:text-slate-200">Academia</a>
                <a href="#equipo" class="block px-3 py-2 rounded-md font-bold uppercase text-slate-800 dark:text-slate-200">Equipo</a>
                <a href="#ofertas" class="block px-3 py-2 rounded-md font-bold uppercase text-slate-800 dark:text-slate-200">Ofertas</a>
                <a href="#builds" class="block px-3 py-2 rounded-md font-bold uppercase text-slate-800 dark:text-slate-200">Builds</a>
                <a href="#videos-destacados" class="block px-3 py-2 rounded-md font-bold uppercase text-slate-800 dark:text-slate-200">Canal</a>
                <a href="#servicios" class="block px-3 py-2 rounded-md font-bold uppercase text-slate-800 dark:text-slate-200">Servicios</a>
                <a href="#blog" class="block px-3 py-2 rounded-md font-bold uppercase text-slate-800 dark:text-slate-200">Blog</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="hero" class="relative pt-24 pb-12 sm:pt-32 sm:pb-32 lg:pb-40 overflow-hidden hero-bg-image section-slant">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="lg:grid lg:grid-cols-12 lg:gap-16 items-center">
                <div class="sm:text-center md:max-w-2xl md:mx-auto lg:col-span-6 lg:text-left fade-in">
                    <div class="inline-flex items-center px-4 py-1.5 rounded-full border border-red-200 dark:border-red-900 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm text-red-600 dark:text-red-400 text-xs font-bold uppercase tracking-widest mb-6 shadow-sm">
                        <span class="flex h-2 w-2 relative mr-2">
                            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                            <span class="relative inline-flex rounded-full h-2 w-2 bg-red-600"></span>
                        </span>
                        Canal Oficial
                    </div>
                    <h1 class="text-6xl tracking-tight font-extrabold text-slate-900 dark:text-white sm:text-7xl md:text-8xl font-teko leading-none">
                        NO VUELES EL DRONE.<br>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-red-500">SÉ EL DRONE.</span>
                    </h1>
                    <p class="mt-6 text-lg text-slate-600 dark:text-slate-400 leading-relaxed">
                        La extensión web del canal <strong>FPV COMPETICION - DRONES</strong>. Guías técnicas, diagramas de montaje y la realidad sin censura del mundo FPV.
                    </p>
                    <div class="mt-8 flex flex-col sm:flex-row gap-4 sm:justify-center lg:justify-start">
                        <a href="https://youtube.com/@FPV-Drones" target="_blank" class="flex items-center justify-center px-8 py-4 border border-transparent font-bold text-white bg-red-600 rounded-lg hover:bg-red-700 transition-all hover:-translate-y-1 shadow-lg">
                            <i class="fab fa-youtube mr-2"></i> Ir al Canal
                        </a>
                        <button onclick="scrollToSection('academia')" class="flex items-center justify-center px-8 py-4 border border-slate-200 dark:border-slate-700 font-bold text-slate-700 dark:text-slate-200 bg-white/50 dark:bg-slate-800/50 backdrop-blur-sm rounded-lg hover:bg-white dark:hover:bg-slate-800 transition-all">
                            <i class="fas fa-graduation-cap mr-2"></i> Aprender
                        </button>
                    </div>
                </div>
                
                <!-- Video Embed Section (GDPR Compliant Facade) -->
                <div class="mt-12 lg:mt-0 lg:col-span-6 fade-in" style="animation-delay: 0.2s;">
                    <div class="relative mx-auto w-full max-w-lg aspect-w-16 shadow-2xl rounded-2xl border-4 border-white/50 dark:border-slate-700/50 bg-slate-900">
                        <!-- Video Facade for Privacy (Updated dynamically) -->
                        <div id="video-placeholder" class="video-facade" data-video-id="vHc5jnxkuzg" onclick="loadYoutubeVideo(this)">
                            <div class="play-button">
                                <div class="play-triangle"></div>
                            </div>
                            <span class="absolute bottom-4 text-white text-xs bg-black/50 px-2 py-1 rounded">Haz click para cargar vídeo (Cookies YouTube)</span>
                        </div>
                    </div>
                    
                    <!-- Stats -->
                    <div class="mt-8 grid grid-cols-3 gap-4 text-center bg-white/60 dark:bg-slate-800/60 backdrop-blur-md rounded-xl p-4 border border-white/50 dark:border-slate-700/50 shadow-sm">
                        <div>
                            <span class="block text-3xl font-bold text-slate-900 dark:text-white font-teko">35K+</span>
                            <span class="text-[10px] text-slate-500 dark:text-slate-400 font-bold uppercase">Subs</span>
                        </div>
                        <div>
                            <span class="block text-3xl font-bold text-slate-900 dark:text-white font-teko">580+</span>
                            <span class="text-[10px] text-slate-500 dark:text-slate-400 font-bold uppercase">Vídeos</span>
                        </div>
                        <div>
                            <span class="block text-3xl font-bold text-slate-900 dark:text-white font-teko">100%</span>
                            <span class="text-[10px] text-slate-500 dark:text-slate-400 font-bold uppercase">Pasión</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Academia de Vuelo Section -->
    <section id="academia" class="py-24 bg-slate-50 dark:bg-dark-bg relative section-slant reveal">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <span class="text-red-600 font-bold tracking-widest uppercase text-xs">Escuela de Pilotos</span>
                <h2 class="text-5xl font-bold text-slate-900 dark:text-white font-teko mt-2">Academia de Vuelo</h2>
                <p class="mt-4 text-slate-600 dark:text-slate-400 max-w-2xl mx-auto font-light text-lg">
                    Del simulador a la realidad. He organizado mis años de experiencia en esta ruta de aprendizaje estructurada.
                </p>
            </div>

            <!-- Tabs Navigation -->
            <div class="flex justify-center mb-12">
                <div class="inline-flex bg-slate-200 dark:bg-slate-800 p-1 rounded-xl">
                    <button class="tab-btn active px-6 py-2 rounded-lg font-teko text-xl text-white bg-slate-900 dark:bg-red-600 shadow-sm transition-all" onclick="switchTab('phase1', this)">Fase 1: Antes de Volar</button>
                    <button class="tab-btn px-6 py-2 rounded-lg font-teko text-xl text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white transition-all" onclick="switchTab('phase2', this)">Fase 2: Simulador</button>
                    <button class="tab-btn px-6 py-2 rounded-lg font-teko text-xl text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white transition-all" onclick="switchTab('phase3', this)">Fase 3: Taller</button>
                </div>
            </div>

            <!-- Tab Contents -->
            <div class="bg-white dark:bg-dark-card rounded-2xl p-8 md:p-12 shadow-[0_20px_50px_rgba(0,0,0,0.05)] border border-slate-100 dark:border-slate-800 min-h-[400px] relative overflow-hidden transition-colors duration-300">
                
                <!-- Content Phase 1 -->
                <div id="phase1" class="tab-content fade-in grid md:grid-cols-2 gap-12 items-center">
                    <div>
                        <div class="w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-xl flex items-center justify-center text-red-600 dark:text-red-400 mb-6">
                            <i class="fas fa-shield-alt text-2xl"></i>
                        </div>
                        <h3 class="text-3xl font-bold text-slate-900 dark:text-white mb-4 font-teko uppercase">Evita Multas y Accidentes</h3>
                        <p class="text-slate-600 dark:text-slate-400 mb-6 leading-relaxed">Lo sé, leer normas es aburrido, pero que te confisquen el drone es peor. Aquí tienes el resumen masticado de la normativa EASA.</p>
                        <ul class="space-y-4 mb-8">
                            <li class="flex items-center text-slate-700 dark:text-slate-300 font-medium"><i class="fas fa-check-circle text-green-500 mr-3"></i> Categoría Abierta (A1/A3)</li>
                            <li class="flex items-center text-slate-700 dark:text-slate-300 font-medium"><i class="fas fa-check-circle text-green-500 mr-3"></i> Registro de Operador Obligatorio</li>
                            <li class="flex items-center text-slate-700 dark:text-slate-300 font-medium"><i class="fas fa-check-circle text-green-500 mr-3"></i> Regla de los 120m de altura</li>
                        </ul>
                    </div>
                    <div class="bg-slate-50 dark:bg-slate-800 p-8 rounded-xl border border-slate-200 dark:border-slate-700 relative">
                        <div class="absolute top-0 right-0 -mt-3 -mr-3 bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide shadow-sm">Activo</div>
                        <h4 class="font-bold text-slate-900 dark:text-white uppercase mb-6 border-b border-slate-200 dark:border-slate-700 pb-2">Requisitos Legales</h4>
                        <div class="space-y-4">
                            <div class="flex items-start gap-4">
                                <div class="bg-white dark:bg-slate-700 p-2 rounded shadow-sm"><i class="fas fa-file-contract text-slate-400 dark:text-slate-300"></i></div>
                                <div>
                                    <span class="block text-xs text-red-600 font-bold uppercase">Requisito #1</span>
                                    <span class="font-medium text-slate-900 dark:text-slate-200">Seguro de Responsabilidad Civil</span>
                                </div>
                            </div>
                            <div class="flex items-start gap-4">
                                <div class="bg-white dark:bg-slate-700 p-2 rounded shadow-sm"><i class="fas fa-id-card text-slate-400 dark:text-slate-300"></i></div>
                                <div>
                                    <span class="block text-xs text-red-600 font-bold uppercase">Requisito #2</span>
                                    <span class="font-medium text-slate-900 dark:text-slate-200">Placa Identificativa Ignífuga</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Phase 2 -->
                <div id="phase2" class="tab-content hidden fade-in grid md:grid-cols-2 gap-12 items-center">
                    <div class="order-2 md:order-1">
                        <div class="bg-slate-900 dark:bg-slate-800 rounded-2xl p-2 shadow-2xl rotate-1 hover:rotate-0 transition-transform duration-500">
                            <div class="bg-slate-800 dark:bg-slate-900 h-64 rounded-xl flex items-center justify-center text-slate-600 border border-slate-700">
                                <i class="fas fa-gamepad text-8xl opacity-50"></i>
                            </div>
                        </div>
                    </div>
                    <div class="order-1 md:order-2">
                        <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-xl flex items-center justify-center text-blue-600 dark:text-blue-400 mb-6">
                            <i class="fas fa-gamepad text-2xl"></i>
                        </div>
                        <h3 class="text-3xl font-bold text-slate-900 dark:text-white mb-4 font-teko uppercase">Gana Dedos en el Simulador</h3>
                        <p class="text-slate-600 dark:text-slate-400 mb-8">Recomiendo encarecidamente <strong>Velocidrone</strong> o <strong>Liftoff</strong>.</p>
                        
                        <div class="space-y-6">
                            <div>
                                <div class="flex justify-between text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">
                                    <span>Vuelo Estabilizado (Angle)</span>
                                    <span>100%</span>
                                </div>
                                <div class="w-full bg-slate-100 dark:bg-slate-700 rounded-full h-2">
                                    <div class="bg-slate-800 dark:bg-slate-400 h-2 rounded-full" style="width: 100%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">
                                    <span>Modo Acro Básico</span>
                                    <span>45%</span>
                                </div>
                                <div class="w-full bg-slate-100 dark:bg-slate-700 rounded-full h-2">
                                    <div class="bg-red-500 h-2 rounded-full" style="width: 45%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Phase 3 -->
                <div id="phase3" class="tab-content hidden fade-in grid md:grid-cols-2 gap-12 items-center">
                    <div>
                        <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-xl flex items-center justify-center text-purple-600 dark:text-purple-400 mb-6">
                            <i class="fas fa-microchip text-2xl"></i>
                        </div>
                        <h3 class="text-3xl font-bold text-slate-900 dark:text-white mb-4 font-teko uppercase">Domina la Bestia (Betaflight)</h3>
                        <p class="text-slate-600 dark:text-slate-400 mb-6">PIDs, Rates, Filtros... Betaflight puede ser una pesadilla. Aquí te explico cómo configurarlo.</p>
                        <a href="#builds" class="text-red-600 dark:text-red-400 font-bold hover:text-slate-900 dark:hover:text-white uppercase tracking-wider text-sm flex items-center gap-2 group">
                            Ir a la sección de Builds <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                        </a>
                    </div>
                    <div class="bg-slate-900 rounded-xl overflow-hidden shadow-2xl border border-slate-700">
                        <div class="bg-slate-800 px-4 py-2 border-b border-slate-700 flex justify-between items-center">
                            <span class="text-xs text-slate-400 font-mono">betaflight-configurator</span>
                            <div class="flex gap-1.5">
                                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                                <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                                <div class="w-3 h-3 rounded-full bg-green-500"></div>
                            </div>
                        </div>
                        <div class="p-6">
                            <h4 class="font-teko text-xl mb-4 text-white">Snippet: Rates Freestyle</h4>
                            <div class="font-mono text-xs text-green-400 mb-4 opacity-90">
                                set roll_rc_rate = 100<br>
                                set pitch_rc_rate = 100<br>
                                set yaw_rc_rate = 100<br>
                                set roll_expo = 20<br>
                                # Type 'save' to apply
                            </div>
                            <button class="w-full bg-white/10 hover:bg-white/20 text-white text-xs py-2 rounded transition flex items-center justify-center gap-2" onclick="navigator.clipboard.writeText('set roll_rc_rate = 100\nset pitch_rc_rate = 100'); showToast('Copiado', 'success')">
                                <i class="fas fa-copy"></i> Copiar Código
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Equipo Necesario -->
    <section id="equipo" class="py-24 bg-white dark:bg-dark-bg transition-colors duration-300 reveal">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-end mb-16">
                <div class="max-w-2xl">
                    <span class="text-red-600 font-bold tracking-widest uppercase text-xs">Hardware & Componentes</span>
                    <h2 class="text-5xl font-bold text-slate-900 dark:text-white font-teko mt-2">El Hangar</h2>
                    <p class="mt-4 text-slate-600 dark:text-slate-400 font-light">No te gastes el sueldo en equipo que no necesitas. Esta es mi selección personal.</p>
                </div>
                
                <!-- Toggle Switch for Gear -->
                <div class="mt-8 md:mt-0 bg-slate-100 dark:bg-slate-800 p-1 rounded-lg inline-flex">
                    <button id="btn-pro" onclick="toggleGear('pro')" class="px-6 py-2 text-sm font-bold rounded-md transition-all bg-red-600 text-white shadow-md">Mi Setup (Pro)</button>
                    <button id="btn-beginner" onclick="toggleGear('beginner')" class="px-6 py-2 text-sm font-bold text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white transition-all">Principiante</button>
                </div>
            </div>

            <!-- Dynamic Gear Grid -->
            <div id="gear-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- Content injected by JS -->
            </div>
        </div>
    </section>

    <!-- Ofertas Section -->
    <section id="ofertas" class="py-24 bg-white dark:bg-dark-card section-slant reveal">
        <div class="max-w-7xl mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-5xl font-bold text-slate-900 dark:text-white font-teko">Rincón del Ahorro</h2>
                <p class="text-slate-600 dark:text-slate-400 mt-2 font-light">Códigos verificados. Algunos enlaces son de afiliados (apoyan el canal).</p>
            </div>
            
            <div class="max-w-md mx-auto mb-10 relative">
                <input type="text" id="couponSearch" placeholder="Buscar tienda (ej. Banggood)..." class="w-full pl-12 pr-4 py-4 border-0 rounded-xl bg-slate-100 dark:bg-slate-800 dark:text-white shadow-inner focus:ring-2 focus:ring-red-500 outline-none">
                <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
            </div>

            <div class="overflow-hidden rounded-xl shadow-xl bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700">
                <table class="min-w-full">
                    <thead class="bg-slate-900 text-white">
                        <tr>
                            <th class="px-6 py-5 text-left text-xs font-bold uppercase">Tienda</th>
                            <th class="px-6 py-5 text-left text-xs font-bold uppercase">Producto</th>
                            <th class="px-6 py-5 text-left text-xs font-bold uppercase text-red-400">Dto.</th>
                            <th class="px-6 py-5 text-right text-xs font-bold uppercase">Código</th>
                        </tr>
                    </thead>
                    <tbody id="couponTableBody" class="divide-y divide-slate-100 dark:divide-slate-700"></tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- Builds Section -->
    <section id="builds" class="py-24 bg-slate-900 text-white relative reveal">
        <div class="absolute inset-0 opacity-10" style="background-image: radial-gradient(#fff 1px, transparent 1px); background-size: 30px 30px;"></div>
        
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="mb-16 flex flex-col md:flex-row justify-between items-end border-b border-slate-700 pb-8">
                <div>
                    <span class="text-red-500 font-bold tracking-widest uppercase text-sm">Proyecto del mes</span>
                    <h2 class="text-6xl font-bold text-white font-teko mt-2">Freestyle 5"</h2>
                    <p class="text-slate-400 text-xl font-teko">"The Bando Killer"</p>
                </div>
                <div class="mt-6 md:mt-0 flex space-x-4">
                    <button class="bg-white text-slate-900 px-6 py-3 rounded text-sm font-bold uppercase transition hover:bg-slate-200"><i class="fas fa-download mr-2 text-red-600"></i>BOM List</button>
                    <button class="bg-slate-800 hover:bg-slate-700 text-white px-6 py-3 rounded text-sm font-bold uppercase transition"><i class="fas fa-code mr-2"></i>CLI Dump</button>
                </div>
            </div>

            <!-- Schematic Diagram Visualization -->
            <div class="bg-slate-800/50 backdrop-blur-sm p-10 rounded-3xl border border-slate-700 relative overflow-hidden">
                <h3 class="text-slate-500 text-xs uppercase tracking-[0.3em] mb-12 text-center">Wiring Diagram Schematic</h3>
                <div class="relative max-w-4xl mx-auto h-[450px] flex items-center justify-center">
                    <div class="component-box w-56 h-56 bg-white dark:bg-slate-200 text-slate-900 z-20 flex flex-col items-center justify-center border-2 border-red-500 shadow-[0_0_50px_rgba(239,68,68,0.2)]">
                        <i class="fas fa-microchip text-5xl mb-3 text-slate-800"></i>
                        <span class="font-teko text-3xl">Flight Controller</span>
                        <span class="text-xs text-slate-500 font-bold uppercase tracking-wider">SpeedyBee F405 V3</span>
                        <div class="absolute -top-1 left-1/2 w-2 h-2 bg-red-500 rounded-full"></div>
                        <div class="absolute -bottom-1 left-1/2 w-2 h-2 bg-red-500 rounded-full"></div>
                        <div class="absolute top-1/2 -left-1 w-2 h-2 bg-red-500 rounded-full"></div>
                        <div class="absolute top-1/2 -right-1 w-2 h-2 bg-red-500 rounded-full"></div>
                    </div>
                    <div class="component-box absolute top-0 w-40 bg-slate-200 hover:bg-white text-slate-900 z-20 cursor-pointer" title="Video Transmitter">
                        <i class="fas fa-broadcast-tower mb-1 text-2xl"></i><br>
                        <span class="text-sm font-bold">DJI O3 Air Unit</span>
                    </div>
                    <svg class="absolute top-12 z-10 w-full h-full pointer-events-none" style="transform: translateY(20px);">
                        <path class="flow-line" d="M450 0 V120" stroke="#94a3b8" stroke-width="2" fill="none" stroke-dasharray="5,5" />
                    </svg>
                    <div class="component-box absolute bottom-0 w-48 bg-slate-200 hover:bg-white text-slate-900 z-20 cursor-pointer" title="Electronic Speed Controller">
                        <i class="fas fa-bolt mb-1 text-2xl text-yellow-600"></i><br>
                        <span class="text-sm font-bold">ESC 50A 4in1</span>
                    </div>
                    <div class="component-box absolute left-0 w-32 bg-slate-200 hover:bg-white text-slate-900 z-20 cursor-pointer" title="Receiver">
                        <i class="fas fa-satellite-dish mb-1 text-2xl text-blue-600"></i><br>
                        <span class="text-sm font-bold">ELRS RX</span>
                    </div>
                    <div class="component-box absolute right-0 w-32 bg-slate-200 hover:bg-white text-slate-900 z-20 cursor-pointer" title="GPS Module">
                        <i class="fas fa-location-arrow mb-1 text-2xl text-green-600"></i><br>
                        <span class="text-sm font-bold">GPS M10</span>
                    </div>
                </div>
                <p class="text-center text-xs text-slate-500 mt-8 uppercase tracking-wider opacity-60">*Representación lógica simplificada.</p>
            </div>
        </div>
    </section>

    <!-- Herramientas Section -->
    <section id="herramientas" class="py-24 bg-slate-50 dark:bg-dark-card relative transition-colors duration-300 reveal">
        <div class="max-w-4xl mx-auto px-4">
            <h2 class="text-4xl font-bold text-slate-900 dark:text-white font-teko text-center mb-10 uppercase">Herramientas de Vuelo</h2>
            <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-8 border border-slate-200 dark:border-slate-700">
                <h3 class="text-2xl font-bold text-slate-900 dark:text-white font-teko mb-6 border-b border-slate-200 dark:border-slate-700 pb-2">
                    <i class="fas fa-calculator mr-2 text-red-600"></i> Calculadora de Tiempo de Vuelo
                </h3>
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">Capacidad Batería (mAh)</label>
                            <input type="number" id="calc-mah" value="1300" class="w-full rounded-md border border-slate-300 dark:border-slate-600 px-4 py-2 bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-red-500 outline-none transition-all">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-slate-700 dark:text-slate-300 mb-2">Estilo de Vuelo</label>
                            <select id="calc-style" class="w-full rounded-md border border-slate-300 dark:border-slate-600 px-4 py-2 bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-white focus:ring-2 focus:ring-red-500 outline-none transition-all">
                                <option value="cinematic">Cinemático (Cruising)</option>
                                <option value="freestyle">Freestyle (Mixto)</option>
                                <option value="racing">Carreras (Full Throttle)</option>
                            </select>
                        </div>
                        <button onclick="calculateFlightTime()" class="w-full bg-slate-900 dark:bg-red-600 hover:bg-slate-700 dark:hover:bg-red-700 text-white font-bold py-3 rounded-lg shadow-md transition-all transform hover:-translate-y-1">
                            Calcular
                        </button>
                    </div>
                    <div class="flex flex-col items-center justify-center bg-slate-100 dark:bg-slate-900 rounded-xl p-6 text-center border border-slate-200 dark:border-slate-700">
                        <span class="text-sm text-slate-500 uppercase tracking-widest font-bold">Tiempo Estimado</span>
                        <div class="text-6xl font-teko font-bold text-slate-900 dark:text-white my-2">
                            <span id="calc-result">0:00</span> <span class="text-2xl text-slate-400">min</span>
                        </div>
                        <p class="text-xs text-slate-400 px-4">*Estimación basada en consumo promedio de un 5 pulgadas.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- NEW: Featured Videos Section (Replaces Services) -->
    <section id="videos-destacados" class="py-24 bg-white dark:bg-dark-bg section-slant transition-colors duration-300 reveal">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-5xl font-bold text-slate-900 dark:text-white font-teko">Lo Mejor del Canal</h2>
                <p class="mt-4 text-slate-600 dark:text-slate-400 font-light">Selección de las listas de reproducción más populares para que no te pierdas nada.</p>
            </div>
            <div class="grid md:grid-cols-3 gap-8">
                <!-- Video Category 1 -->
                <a href="https://www.youtube.com/@FPV-Drones/playlists?view=50&sort=dd&shelf_id=3" target="_blank" class="group bg-white dark:bg-dark-card p-8 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 flex flex-col text-center">
                    <div class="w-16 h-16 bg-slate-900 dark:bg-slate-700 text-white rounded-full flex items-center justify-center mb-6 mx-auto group-hover:bg-red-600 transition-colors shadow-lg">
                        <i class="fas fa-book-open text-2xl"></i>
                    </div>
                    <h3 class="text-2xl font-teko font-bold text-slate-900 dark:text-white mb-3 uppercase">Tutoriales desde Cero</h3>
                    <p class="text-slate-600 dark:text-slate-400 text-sm leading-relaxed mb-6">La guía definitiva para empezar en FPV sin estrellarte (demasiado) el primer día.</p>
                    <span class="mt-auto text-red-600 font-bold uppercase text-xs tracking-widest">Ver Lista <i class="fas fa-arrow-right ml-1"></i></span>
                </a>
                <!-- Video Category 2 -->
                <a href="https://www.youtube.com/@FPV-Drones/videos" target="_blank" class="group bg-white dark:bg-dark-card p-8 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 flex flex-col text-center">
                    <div class="w-16 h-16 bg-slate-900 dark:bg-slate-700 text-white rounded-full flex items-center justify-center mb-6 mx-auto group-hover:bg-red-600 transition-colors shadow-lg">
                        <i class="fas fa-microscope text-2xl"></i>
                    </div>
                    <h3 class="text-2xl font-teko font-bold text-slate-900 dark:text-white mb-3 uppercase">Reviews Honestas</h3>
                    <p class="text-slate-600 dark:text-slate-400 text-sm leading-relaxed mb-6">Analizo lo último del mercado. Si es basura, te lo digo. Si es oro, también.</p>
                    <span class="mt-auto text-red-600 font-bold uppercase text-xs tracking-widest">Ver Reviews <i class="fas fa-arrow-right ml-1"></i></span>
                </a>
                <!-- Video Category 3 -->
                <a href="https://www.youtube.com/@FPV-Drones/shorts" target="_blank" class="group bg-white dark:bg-dark-card p-8 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 flex flex-col text-center">
                    <div class="w-16 h-16 bg-slate-900 dark:bg-slate-700 text-white rounded-full flex items-center justify-center mb-6 mx-auto group-hover:bg-red-600 transition-colors shadow-lg">
                        <i class="fas fa-flag-checkered text-2xl"></i>
                    </div>
                    <h3 class="text-2xl font-teko font-bold text-slate-900 dark:text-white mb-3 uppercase">Vlogs y Competición</h3>
                    <p class="text-slate-600 dark:text-slate-400 text-sm leading-relaxed mb-6">Vente conmigo a las carreras y eventos. Pura adrenalina y backstage.</p>
                    <span class="mt-auto text-red-600 font-bold uppercase text-xs tracking-widest">Ver Vlogs <i class="fas fa-arrow-right ml-1"></i></span>
                </a>
            </div>
        </div>
    </section>

    <!-- Servicios Section (Grabación FPV) -->
    <section id="servicios" class="min-h-[30vh] flex flex-col justify-center py-12 bg-slate-50 dark:bg-dark-card section-slant transition-colors duration-300 reveal">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full">
            <div class="text-center mb-8">
                <h2 class="text-5xl font-bold text-slate-900 dark:text-white font-teko">Servicios Profesionales</h2>
                <p class="mt-2 text-slate-600 dark:text-slate-400 font-light">Producción audiovisual de alto nivel.</p>
            </div>
            <div class="max-w-md mx-auto">
                <div class="group bg-white dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 flex flex-col text-center relative overflow-hidden">
                    <!-- Decoración sutil -->
                    <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-red-500 to-red-600"></div>
                    
                    <div class="w-16 h-16 bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-white rounded-full flex items-center justify-center mb-4 mx-auto group-hover:bg-red-600 group-hover:text-white transition-colors duration-300 shadow-md">
                        <i class="fas fa-video text-2xl"></i>
                    </div>
                    
                    <h3 class="text-2xl font-teko font-bold text-slate-900 dark:text-white mb-2 uppercase">Grabación FPV</h3>
                    
                    <p class="text-slate-600 dark:text-slate-300 text-sm leading-relaxed mb-6">
                        Planos cinemáticos imposibles para videoclips, inmobiliaria y publicidad. Calidad 5K estabilizada.
                    </p>
                    
                    <button onclick="openContactModal('Grabación FPV')" class="mt-auto w-full bg-slate-900 dark:bg-red-600 text-white font-bold py-3 rounded-xl hover:bg-slate-800 dark:hover:bg-red-700 transition shadow-lg flex items-center justify-center gap-2 text-sm">
                        <span>Pedir Presupuesto</span>
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Blog Section -->
    <section id="blog" class="py-24 bg-slate-50 dark:bg-dark-bg reveal">
        <div class="max-w-7xl mx-auto px-4">
            <h2 class="text-4xl font-bold text-slate-900 dark:text-white font-teko uppercase text-center mb-10">Noticias y Salseo</h2>
            
            <!-- Admin Buttons -->
            <div id="admin-controls" class="hidden text-center mb-8">
                 <button onclick="toggleAdminPanel()" class="bg-slate-800 text-white px-4 py-2 rounded shadow hover:bg-slate-700"><i class="fas fa-plus"></i> Nueva Entrada</button>
            </div>

            <div id="blog-posts-container" class="grid md:grid-cols-3 gap-8">
                <!-- Posts injected by JS -->
                <div class="text-center col-span-3 text-slate-500">Cargando noticias...</div>
            </div>
        </div>
    </section>

    <!-- Newsletter Section -->
    <section class="py-20 bg-slate-900 dark:bg-black border-t border-slate-800 reveal">
        <div class="max-w-4xl mx-auto px-4 text-center">
            <h2 class="text-3xl font-teko font-bold text-white mb-4 uppercase">¿Quieres volar mejor?</h2>
            <p class="text-slate-400 mb-8">Únete a la newsletter. Sin spam, solo trucos de Betaflight, ofertas flash y actualizaciones del canal.</p>
            <form class="flex flex-col sm:flex-row gap-4 justify-center max-w-lg mx-auto" onsubmit="event.preventDefault(); showToast('¡Gracias por suscribirte!', 'success');">
                <input type="email" placeholder="Tu email aquí..." class="px-5 py-3 rounded-lg bg-slate-800 border border-slate-700 text-white focus:outline-none focus:border-red-600 flex-grow" required>
                <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-8 rounded-lg transition-all hover:scale-105">Suscribirme</button>
            </form>
        </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="py-24 bg-slate-50 dark:bg-dark-card relative transition-colors duration-300 reveal">
        <div class="max-w-3xl mx-auto px-4">
            <h2 class="text-4xl font-bold text-slate-900 dark:text-white font-teko text-center mb-10 uppercase">Preguntas Frecuentes</h2>
            <div class="space-y-4">
                <div class="border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden">
                    <button class="flex items-center justify-between w-full p-4 bg-white dark:bg-slate-800 text-left font-bold text-slate-900 dark:text-white focus:outline-none" onclick="toggleFaq(this)">
                        <span>¿Necesito licencia para volar un drone FPV?</span>
                        <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div class="hidden p-4 bg-slate-50 dark:bg-slate-900 text-slate-600 dark:text-slate-400 text-sm border-t border-slate-200 dark:border-slate-700">
                        Sí, para la mayoría de drones FPV (excepto juguetes de <250g en interiores) necesitas registrarte como operador en AESA, tener seguro de responsabilidad civil y, dependiendo de la categoría, aprobar el examen A1/A3.
                    </div>
                </div>
                <div class="border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden">
                    <button class="flex items-center justify-between w-full p-4 bg-white dark:bg-slate-800 text-left font-bold text-slate-900 dark:text-white focus:outline-none" onclick="toggleFaq(this)">
                        <span>¿Cuánto cuesta empezar en esto?</span>
                        <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div class="hidden p-4 bg-slate-50 dark:bg-slate-900 text-slate-600 dark:text-slate-400 text-sm border-t border-slate-200 dark:border-slate-700">
                        Puedes empezar con un simulador y una emisora por unos 80-100€. Un kit de inicio analógico completo ronda los 300€, mientras que un equipo digital de gama media puede subir a los 800-1000€.
                    </div>
                </div>
                <div class="border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden">
                    <button class="flex items-center justify-between w-full p-4 bg-white dark:bg-slate-800 text-left font-bold text-slate-900 dark:text-white focus:outline-none" onclick="toggleFaq(this)">
                        <span>¿Digital o Analógico?</span>
                        <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div class="hidden p-4 bg-slate-50 dark:bg-slate-900 text-slate-600 dark:text-slate-400 text-sm border-t border-slate-200 dark:border-slate-700">
                        Si el presupuesto lo permite, Digital (DJI O3, Walksnail, HDZero) es el futuro: mejor imagen y penetración. Analógico sigue siendo rey en latencia ultra-baja para carreras y es más económico para empezar.
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- NEW: Contact Modal -->
    <div id="contact-modal" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-white dark:bg-slate-800 rounded-lg max-w-md w-full p-6 relative border border-slate-700 shadow-2xl">
            <button onclick="document.getElementById('contact-modal').classList.add('hidden')" class="absolute top-4 right-4 text-slate-400 hover:text-white"><i class="fas fa-times"></i></button>
            <h3 class="text-2xl font-teko text-slate-900 dark:text-white mb-2">Contactar</h3>
            <p class="text-sm text-slate-500 mb-6">Estás interesado en: <strong id="contact-subject" class="text-red-500">Servicio</strong></p>
            
            <form onsubmit="event.preventDefault(); showToast('Mensaje enviado. Te responderé pronto.', 'success'); document.getElementById('contact-modal').classList.add('hidden');" class="space-y-4">
                <div>
                    <label class="block text-xs font-bold uppercase text-slate-500 mb-1">Tu Email</label>
                    <input type="email" required class="w-full p-3 rounded bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-white border border-slate-300 dark:border-slate-600 focus:border-red-500 outline-none">
                </div>
                <div>
                    <label class="block text-xs font-bold uppercase text-slate-500 mb-1">Mensaje</label>
                    <textarea rows="4" required class="w-full p-3 rounded bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-white border border-slate-300 dark:border-slate-600 focus:border-red-500 outline-none"></textarea>
                </div>
                <button type="submit" class="w-full bg-red-600 text-white py-3 rounded font-bold hover:bg-red-700 transition shadow-lg">Enviar Solicitud</button>
            </form>
        </div>
    </div>

    <!-- Cookie Banner Advanced (RGPD Compliant) -->
    <div id="cookie-banner" class="flex flex-col md:flex-row items-center justify-between gap-6 shadow-[0_-4px_20px_rgba(0,0,0,0.5)] border-t border-slate-700 p-6">
        <div class="text-slate-300 text-sm flex-1">
            <h4 class="text-white font-bold mb-2">🍪 Configuración de Privacidad</h4>
            <p class="leading-relaxed">
                Utilizamos cookies propias y de terceros para fines analíticos y para mostrarte contenido personalizado (como vídeos de YouTube). 
                Puedes aceptar todas las cookies, rechazarlas o configurarlas a tu gusto. 
                Consulta nuestra <a href="#" onclick="openLegalModal('cookies')" class="text-red-500 hover:underline font-bold">Política de Cookies</a> para más detalles.
            </p>
        </div>
        <div class="flex flex-wrap gap-3 w-full md:w-auto justify-end">
             <button onclick="cookieManager.openSettings()" class="px-4 py-2 border border-slate-500 text-slate-300 rounded-lg hover:bg-slate-800 transition text-sm font-medium">
                Configurar
            </button>
             <button onclick="cookieManager.rejectAll()" class="px-4 py-2 border border-red-900 text-red-400 rounded-lg hover:bg-red-900/20 transition text-sm font-medium">
                Rechazar
            </button>
            <button onclick="cookieManager.acceptAll()" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition text-sm shadow-lg shadow-red-600/20">
                Aceptar Todo
            </button>
        </div>
    </div>

    <!-- Cookie Settings Modal -->
    <div id="cookie-settings-modal" class="fixed inset-0 z-[101] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-white dark:bg-slate-800 rounded-xl max-w-lg w-full p-6 shadow-2xl relative">
            <h3 class="text-2xl font-bold text-slate-900 dark:text-white font-teko mb-4">Configuración de Cookies</h3>
            <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Gestiona tus preferencias de consentimiento. Las cookies técnicas son obligatorias para el funcionamiento de la web.</p>
            
            <div class="space-y-4 mb-8">
                <!-- Technical -->
                <div class="flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg">
                    <div>
                        <span class="font-bold text-slate-900 dark:text-white block">Técnicas (Necesarias)</span>
                        <span class="text-xs text-slate-500 dark:text-slate-400">Sesión, carrito, preferencias.</span>
                    </div>
                    <input type="checkbox" checked disabled class="w-5 h-5 text-red-600 rounded bg-slate-200 border-slate-400 cursor-not-allowed opacity-50">
                </div>
                <!-- Analytics -->
                <div class="flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg">
                    <div>
                        <span class="font-bold text-slate-900 dark:text-white block">Analíticas</span>
                        <span class="text-xs text-slate-500 dark:text-slate-400">Google Analytics, estadísticas anónimas.</span>
                    </div>
                    <div class="relative inline-block w-12 mr-2 align-middle select-none transition duration-200 ease-in">
                        <input type="checkbox" name="toggle" id="toggle-analytics" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
                        <label for="toggle-analytics" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                    </div>
                </div>
                <!-- Marketing -->
                <div class="flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg">
                    <div>
                        <span class="font-bold text-slate-900 dark:text-white block">Marketing / Terceros</span>
                        <span class="text-xs text-slate-500 dark:text-slate-400">YouTube Embeds, Redes Sociales.</span>
                    </div>
                    <div class="relative inline-block w-12 mr-2 align-middle select-none transition duration-200 ease-in">
                        <input type="checkbox" name="toggle" id="toggle-marketing" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
                        <label for="toggle-marketing" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"></label>
                    </div>
                </div>
            </div>

            <div class="flex justify-end gap-3">
                <button onclick="document.getElementById('cookie-settings-modal').classList.add('hidden')" class="px-4 py-2 text-slate-500 hover:text-slate-800 dark:hover:text-white transition">Cancelar</button>
                <button onclick="cookieManager.saveSettings()" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-lg transition">Guardar Preferencias</button>
            </div>
        </div>
    </div>

    <!-- Modales Legales (Detailed) -->
    <div id="legal-modal" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-white dark:bg-slate-800 rounded-xl max-w-3xl w-full max-h-[85vh] overflow-y-auto relative shadow-2xl">
            <!-- Sticky Header -->
            <div class="sticky top-0 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 p-6 flex justify-between items-center z-10">
                <h2 id="legal-title" class="text-3xl font-bold font-teko dark:text-white"></h2>
                <button onclick="document.getElementById('legal-modal').classList.add('hidden')" class="text-slate-400 hover:text-red-500 transition"><i class="fas fa-times text-2xl"></i></button>
            </div>
            
            <div id="legal-content" class="p-8 prose dark:prose-invert max-w-none text-slate-600 dark:text-slate-300 text-sm leading-relaxed">
                <!-- Content injected via JS -->
            </div>
        </div>
    </div>

    <!-- Blog Read Modal -->
    <div id="read-modal" class="fixed inset-0 z-[60] hidden modal-overlay overflow-y-auto">
        <div class="flex items-center justify-center min-h-screen p-0 sm:p-4">
            <div class="bg-white dark:bg-slate-900 w-full sm:max-w-3xl sm:rounded-2xl shadow-2xl relative flex flex-col max-h-screen sm:max-h-[90vh]">
                <button onclick="closeReadModal()" class="absolute top-4 right-4 z-10 bg-black/50 text-white w-10 h-10 rounded-full flex items-center justify-center backdrop-blur-sm"><i class="fas fa-times"></i></button>
                <div class="h-64 w-full relative shrink-0">
                    <img id="read-post-image" src="" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-gradient-to-t from-slate-900 to-transparent opacity-80"></div>
                    <div class="absolute bottom-6 left-6 right-6">
                        <h2 id="read-post-title" class="text-3xl font-bold text-white font-teko"></h2>
                    </div>
                </div>
                <div class="p-8 overflow-y-auto">
                    <div id="read-post-content" class="prose dark:prose-invert max-w-none text-slate-700 dark:text-slate-300"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Modal -->
    <div id="admin-modal" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-white dark:bg-slate-800 rounded-lg max-w-md w-full p-6 relative border border-slate-700">
            <button onclick="toggleAdminPanel()" class="absolute top-4 right-4 text-slate-400 hover:text-white"><i class="fas fa-times"></i></button>
            
            <!-- Login -->
            <div id="login-section">
                <h3 class="text-xl font-teko text-white mb-4">Acceso Editor</h3>
                <form id="login-form" class="space-y-4">
                    <input type="email" id="login-email" placeholder="Email" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600">
                    <input type="password" id="login-password" placeholder="Contraseña" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600">
                    <button type="submit" class="w-full bg-red-600 text-white py-2 rounded font-bold hover:bg-red-700">Entrar</button>
                </form>
            </div>

            <!-- Editor -->
            <div id="editor-section" class="hidden">
                <div class="flex justify-between mb-4">
                    <h3 class="text-xl font-teko text-white">Editar Noticia</h3>
                    <button onclick="logout()" class="text-xs text-red-400">Salir</button>
                </div>
                <form id="post-form" class="space-y-4">
                    <input type="text" id="post-title" placeholder="Título" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600" required>
                    <input type="text" id="post-category" placeholder="Categoría (Review, Tutorial...)" class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600" required>
                    <input type="file" id="file-input" accept="image/*" class="w-full text-slate-400 text-sm">
                    <input type="hidden" id="post-image-base64">
                    <textarea id="post-content" rows="4" placeholder="Contenido..." class="w-full p-2 rounded bg-slate-700 text-white border border-slate-600" required></textarea>
                    <button type="submit" class="w-full bg-green-600 text-white py-2 rounded font-bold hover:bg-green-700">Publicar</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Footer -->
    <footer class="bg-slate-900 dark:bg-black text-slate-400 py-12 border-t-4 border-red-600">
        <div class="max-w-7xl mx-auto px-4 grid md:grid-cols-4 gap-8">
            <div class="col-span-1 md:col-span-2">
                <span class="font-teko text-4xl text-white">FPV <span class="text-red-600">COMPETICION</span></span>
                <p class="mt-4 text-sm max-w-xs">Tutoriales, reviews, montajes y la mejor comunidad de FPV en español.</p>
            </div>
            <div>
                <h4 class="text-white font-bold uppercase text-sm mb-4">Legal (Obligatorio)</h4>
                <ul class="space-y-2 text-sm">
                    <li><button onclick="openLegalModal('legal')" class="hover:text-red-500">Aviso Legal</button></li>
                    <li><button onclick="openLegalModal('privacy')" class="hover:text-red-500">Política Privacidad</button></li>
                    <li><button onclick="openLegalModal('cookies')" class="hover:text-red-500">Cookies</button></li>
                </ul>
            </div>
            <div>
                <h4 class="text-white font-bold uppercase text-sm mb-4">Admin</h4>
                <button onclick="toggleAdminPanel()" class="text-sm hover:text-white"><i class="fas fa-lock mr-2"></i>Acceso Editor</button>
            </div>
        </div>
        <div class="text-center mt-10 text-xs text-slate-600">
            &copy; 2026 FPV-Drones. Todos los derechos reservados.
        </div>
    </footer>

    <!-- Logic -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, deleteDoc, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // FIREBASE CONFIG (Reemplazar con tus datos reales en producción)
        let firebaseConfig;
        let appId = 'default-app-id';
        if (window.location.hostname === 'localhost' || window.location.hostname.includes('127.0.0.1')) {
             if (typeof __firebase_config !== 'undefined') {
                 firebaseConfig = JSON.parse(__firebase_config);
                 appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
             }
        } 
        if (!firebaseConfig) {
            // Placeholder: NO usar keys de prod en código cliente sin reglas de seguridad (Firestore Rules)
            firebaseConfig = {
                apiKey: "AIzaSyDnaFkYwdNNInlwDcQT7Kjg2qZ2w08YOMU", 
                authDomain: "web-fpv-competicion.firebaseapp.com",
                projectId: "web-fpv-competicion",
                storageBucket: "web-fpv-competicion.firebasestorage.app",
                messagingSenderId: "736830142498",
                appId: "1:736830142498:web:4e967f2e50db6f3771f27b"
            };
        }

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;

        // AUTH & ADMIN UI
        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            const loginSec = document.getElementById('login-section');
            const editSec = document.getElementById('editor-section');
            const adminControls = document.getElementById('admin-controls');
            
            if(user) {
                loginSec.classList.add('hidden');
                editSec.classList.remove('hidden');
                adminControls.classList.remove('hidden');
                showToast(`Hola ${user.email}`, 'success');
            } else {
                loginSec.classList.remove('hidden');
                editSec.classList.add('hidden');
                adminControls.classList.add('hidden');
            }
        });

        // BLOG LOGIC
        const collectionPath = (typeof __app_id !== 'undefined' && (window.location.hostname === 'localhost' || window.location.hostname.includes('127.0.0.1')))
                ? collection(db, 'artifacts', appId, 'public', 'data', 'blog_posts')
                : collection(db, 'blog_posts');

        const q = query(collectionPath); 

        onSnapshot(q, (snapshot) => {
            const container = document.getElementById('blog-posts-container');
            container.innerHTML = '';
            
            if (snapshot.empty) {
                container.innerHTML = '<p class="text-center col-span-3">No hay noticias.</p>';
                return;
            }

            snapshot.forEach(doc => {
                const post = doc.data();
                const div = document.createElement('div');
                div.className = "bg-white dark:bg-dark-card rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition group cursor-pointer h-full flex flex-col";
                div.onclick = () => openReadModal(post);

                div.innerHTML = `
                    <div class="h-48 bg-slate-200 overflow-hidden relative">
                         <img src="${post.image || 'https://via.placeholder.com/400'}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                         <span class="absolute top-2 left-2 bg-red-600 text-white text-xs font-bold px-2 py-1 rounded shadow">${post.category || 'News'}</span>
                    </div>
                    <div class="p-6 flex flex-col flex-grow">
                        <h3 class="font-teko text-2xl dark:text-white leading-none mb-2">${post.title}</h3>
                        <p class="text-sm text-slate-500 dark:text-slate-400 line-clamp-3">${post.content}</p>
                    </div>
                `;
                container.appendChild(div);
            });
        });

        // ACTIONS
        window.login = async (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-password').value;
            try {
                await signInWithEmailAndPassword(auth, email, pass);
            } catch(error) {
                showToast("Error de acceso: " + error.message, 'error');
            }
        };

        window.logout = () => signOut(auth);

        window.createPost = async (e) => {
            e.preventDefault();
            try {
                await addDoc(collectionPath, {
                    title: document.getElementById('post-title').value,
                    category: document.getElementById('post-category').value,
                    content: document.getElementById('post-content').value,
                    image: document.getElementById('post-image-base64').value,
                    createdAt: new Date().toISOString()
                });
                showToast("Noticia publicada", 'success');
                document.getElementById('post-form').reset();
                toggleAdminPanel();
            } catch(e) {
                showToast("Error: " + e.message, 'error');
            }
        }

        // Event Listeners for Forms
        document.getElementById('login-form').addEventListener('submit', window.login);
        document.getElementById('post-form').addEventListener('submit', window.createPost);
        
        // Image Processing and Upload Logic
        document.getElementById('file-input').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if(file) {
                // Use FileReader to preview and Canvas to resize
                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = new Image();
                    img.src = event.target.result;
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        // Aggressive resize for Web optimization
                        const MAX_WIDTH = 800; 
                        const scaleSize = MAX_WIDTH / img.width;
                        canvas.width = MAX_WIDTH;
                        canvas.height = img.height * scaleSize;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                        
                        // Convert to Blob for upload
                        canvas.toBlob(async (blob) => {
                            const formData = new FormData();
                            formData.append('image', blob, 'image.jpg');
                            
                            // Show loading state (optional UI enhancement)
                            showToast('Subiendo imagen...', 'info');

                            try {
                                const response = await fetch('upload.php', { method: 'POST', body: formData });
                                
                                if(response.ok) {
                                    const data = await response.json();
                                    if(data.success && data.url) {
                                        // Save URL to hidden input for Firestore
                                        document.getElementById('post-image-base64').value = data.url;
                                        showToast('Imagen subida correctamente', 'success');
                                    } else {
                                        throw new Error(data.error || 'Error en servidor');
                                    }
                                } else {
                                    throw new Error('Script de subida no encontrado (404)');
                                }
                            } catch (e) {
                                console.warn("Upload failed:", e);
                                // Fallback: Use Base64 for Firestore if upload fails (e.g. locally)
                                showToast('Aviso: Usando almacenamiento local (Base64)', 'info');
                                document.getElementById('post-image-base64').value = canvas.toDataURL('image/jpeg', 0.6);
                            }
                        }, 'image/jpeg', 0.7);
                    }
                };
                reader.readAsDataURL(file);
            }
        });
        
        // Expose functions global
        window.toggleAdminPanel = () => {
             const modal = document.getElementById('admin-modal');
             modal.classList.toggle('hidden');
        }
        window.openReadModal = (post) => {
            document.getElementById('read-post-title').innerText = post.title;
            document.getElementById('read-post-image').src = post.image;
            document.getElementById('read-post-content').innerText = post.content;
            document.getElementById('read-modal').classList.remove('hidden');
        }
        window.closeReadModal = () => document.getElementById('read-modal').classList.add('hidden');

    </script>

    <!-- UI Logic & Cookie Management (Advanced) -->
    <script>
        // --- ADVANCED COOKIE MANAGER (GDPR/LSSI-CE) ---
        const cookieManager = {
            consent: null,
            
            init: function() {
                const stored = localStorage.getItem('fpv_cookie_consent');
                if (stored) {
                    this.consent = JSON.parse(stored);
                    this.applySettings();
                } else {
                    setTimeout(() => document.getElementById('cookie-banner').classList.add('show'), 1000);
                }
            },

            acceptAll: function() {
                this.consent = { technical: true, analytics: true, marketing: true };
                this.saveAndApply();
                showToast('Has aceptado todas las cookies', 'success');
            },

            rejectAll: function() {
                this.consent = { technical: true, analytics: false, marketing: false };
                this.saveAndApply();
                showToast('Has rechazado las cookies no esenciales', 'info');
            },

            openSettings: function() {
                // Pre-fill toggle states based on current consent or defaults
                const current = this.consent || { analytics: false, marketing: false };
                document.getElementById('toggle-analytics').checked = current.analytics;
                document.getElementById('toggle-marketing').checked = current.marketing;
                document.getElementById('cookie-settings-modal').classList.remove('hidden');
            },

            saveSettings: function() {
                this.consent = {
                    technical: true,
                    analytics: document.getElementById('toggle-analytics').checked,
                    marketing: document.getElementById('toggle-marketing').checked
                };
                this.saveAndApply();
                document.getElementById('cookie-settings-modal').classList.add('hidden');
                showToast('Preferencias guardadas', 'success');
            },

            saveAndApply: function() {
                localStorage.setItem('fpv_cookie_consent', JSON.stringify(this.consent));
                document.getElementById('cookie-banner').classList.remove('show');
                this.applySettings();
            },

            applySettings: function() {
                // Here we would conditionally load scripts
                if (this.consent.analytics) {
                    console.log('Cargando Google Analytics...');
                    // loadScript('https://www.googletagmanager.com/gtag/js?id=UA-XXXXX-Y');
                }
                if (this.consent.marketing) {
                    console.log('Habilitando Embeds de terceros...');
                    // Unblock iframes or other marketing scripts
                }
            },
            
            checkConsent: function(category) {
                return this.consent && this.consent[category];
            }
        };

        // --- FACADE PATTERN (PRIVACY FRIENDLY YOUTUBE) ---
        function loadYoutubeVideo(element) {
            // Check Marketing consent first
            if (!cookieManager.checkConsent('marketing')) {
                if(confirm("Para ver el vídeo, necesitas activar las cookies de Marketing/Terceros. ¿Deseas activarlas ahora?")) {
                    cookieManager.consent = cookieManager.consent || { technical: true };
                    cookieManager.consent.marketing = true;
                    cookieManager.saveAndApply();
                } else {
                    return; // Stop if consent refused
                }
            }
            
            // If consent is OK, load video
            const videoId = element.getAttribute('data-video-id') || 'vHc5jnxkuzg';
            const iframe = document.createElement('iframe');
            iframe.setAttribute('src', `https://www.youtube-nocookie.com/embed/${videoId}?autoplay=1`);
            iframe.setAttribute('frameborder', '0');
            iframe.setAttribute('allow', 'autoplay; encrypted-media; picture-in-picture');
            iframe.setAttribute('allowfullscreen', 'true');
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            
            element.parentNode.replaceChild(iframe, element);
        }

        // Auto-update YouTube Facade with latest video
        async function updateLatestVideo() {
            const channelId = 'UCMf2ohoBrB1pgErsMa21SKg'; 
            try {
                const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=https://www.youtube.com/feeds/videos.xml?channel_id=${channelId}`);
                const data = await response.json();
                if (data.items && data.items.length > 0) {
                    const item = data.items[0];
                    const latestVideoId = item.guid.split(':')[2];
                    const thumb = item.thumbnail;
                    
                    const placeholder = document.getElementById('video-placeholder');
                    if (placeholder && latestVideoId) {
                        placeholder.setAttribute('data-video-id', latestVideoId);
                        placeholder.style.backgroundImage = `url('${thumb}')`;
                    }
                }
            } catch (error) {
                console.error('No se pudo actualizar el vídeo automáticamente:', error);
            }
        }

        // --- THEME LOGIC ---
        const html = document.documentElement;
        const toggleBtns = [document.getElementById('theme-toggle-desktop'), document.getElementById('theme-toggle-mobile')];
        
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            html.classList.add('dark');
        }

        toggleBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                html.classList.toggle('dark');
                localStorage.theme = html.classList.contains('dark') ? 'dark' : 'light';
            });
        });

        // --- LEGAL MODALS CONTENT (DETAILED TEXT) ---
        function openLegalModal(type) {
            const modal = document.getElementById('legal-modal');
            const titleEl = document.getElementById('legal-title');
            const contentEl = document.getElementById('legal-content');
            
            modal.classList.remove('hidden');

            if (type === 'cookies') {
                titleEl.innerText = 'Política de Cookies';
                contentEl.innerHTML = `
                    <h3 class="text-xl font-bold mb-2">¿Qué son las cookies?</h3>
                    <p class="mb-4">Una cookie es un fichero que se descarga en su ordenador al acceder a determinadas páginas web. Las cookies permiten a una página web, entre otras cosas, almacenar y recuperar información sobre los hábitos de navegación de un usuario o de su equipo y, dependiendo de la información que contengan y de la forma en que utilice su equipo, pueden utilizarse para reconocer al usuario.</p>
                    
                    <h3 class="text-xl font-bold mb-2">Tipos de cookies que utilizamos</h3>
                    <ul class="list-disc pl-5 mb-4 space-y-2">
                        <li><strong>Cookies Técnicas (Necesarias):</strong> Son aquellas que permiten al usuario la navegación a través de una página web y la utilización de las diferentes opciones o servicios que en ella existan (ej. controlar el tráfico, identificar la sesión, acceder a partes de acceso restringido como el editor).</li>
                        <li><strong>Cookies de Análisis:</strong> Son aquellas que nos permiten cuantificar el número de usuarios y así realizar la medición y análisis estadístico de la utilización que hacen los usuarios del servicio ofertado. Para ello se analiza su navegación en nuestra página web con el fin de mejorar la oferta de productos o servicios que le ofrecemos (Google Analytics).</li>
                        <li><strong>Cookies de Marketing / Terceros:</strong> Son aquellas utilizadas por complementos externos de contenido (como YouTube o Google Maps) para que el usuario pueda visualizar contenidos multimedia. Estas cookies son gestionadas por terceros y pueden rastrear su comportamiento.</li>
                    </ul>

                    <h3 class="text-xl font-bold mb-2">Gestión de cookies</h3>
                    <p class="mb-4">Puede usted permitir, bloquear o eliminar las cookies instaladas en su equipo mediante la configuración de las opciones del navegador instalado en su ordenador o mediante nuestro panel de configuración.</p>
                `;
            } else if (type === 'privacy') {
                titleEl.innerText = 'Política de Privacidad';
                contentEl.innerHTML = `
                    <p class="mb-4">En cumplimiento del Reglamento (UE) 2016/679 (RGPD) y la Ley Orgánica 3/2018 (LOPDGDD), le informamos que sus datos personales serán tratados por <strong>[Tu Nombre/Empresa]</strong> con la finalidad de gestionar su solicitud o suscripción.</p>
                    <p class="mb-4"><strong>Responsable:</strong> Alex FPV<br><strong>Finalidad:</strong> Gestión de usuarios y comunicaciones.<br><strong>Legitimación:</strong> Consentimiento del interesado.<br><strong>Derechos:</strong> Acceder, rectificar y suprimir los datos, así como otros derechos, como se explica en la información adicional.</p>
                `;
            } else {
                titleEl.innerText = 'Aviso Legal';
                contentEl.innerHTML = `
                    <p class="mb-4">En cumplimiento del artículo 10 de la Ley 34/2002, de  11 de julio, de Servicios de la Sociedad de la Información y Comercio Electrónico (LSSICE), a continuación se exponen los datos identificativos de la empresa.</p>
                    <p><strong>Titular:</strong> Alex FPV<br><strong>Domicilio:</strong> Gipuzkoa, España<br><strong>Email:</strong> hola@fpv-drones.com</p>
                    <p class="mt-4">Este sitio web utiliza enlaces de afiliados. Esto significa que si hace clic en un enlace y realiza una compra, podemos recibir una pequeña comisión sin coste adicional para usted.</p>
                `;
            }
        }

        // --- NEW: CONTACT MODAL ---
        function openContactModal(subject) {
            document.getElementById('contact-subject').innerText = subject;
            document.getElementById('contact-modal').classList.remove('hidden');
        }

        // --- TABS LOGIC ---
        function switchTab(tabId, btn) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');
            document.querySelectorAll('.tab-btn').forEach(el => {
                el.classList.remove('bg-slate-900', 'text-white', 'shadow-sm', 'dark:bg-red-600');
                el.classList.add('text-slate-500', 'hover:text-slate-900', 'dark:text-slate-400', 'dark:hover:text-white');
            });
            btn.classList.remove('text-slate-500', 'hover:text-slate-900', 'dark:text-slate-400', 'dark:hover:text-white');
            btn.classList.add('bg-slate-900', 'text-white', 'shadow-sm', 'dark:bg-red-600');
        }

        // --- GEAR LOGIC ---
        const gearData = {
            pro: [
                { name: "DJI Goggles 2", type: "Gafas", desc: "Digital HD, OLED, baja latencia.", icon: "fa-vr-cardboard" },
                { name: "Radiomaster Boxer", type: "Emisora", desc: "ELRS 2.4GHz interno. 1W potencia.", icon: "fa-gamepad" },
                { name: "AOS 5 V5", type: "Drone", desc: "Frame anti-vibraciones, Motores 2207.", icon: "fa-paper-plane" },
                { name: "Torvol Pitstop", type: "Mochila", desc: "La mochila estándar de la industria.", icon: "fa-suitcase" }
            ],
            beginner: [
                { name: "Emax Tinyhawk III", type: "Kit RTF", desc: "Todo en uno. Indestructible.", icon: "fa-box-open" },
                { name: "Radiomaster Pocket", type: "Emisora", desc: "Económica, pequeña y ELRS.", icon: "fa-gamepad" },
                { name: "Skyzone Cobra X", type: "Gafas", desc: "Las mejores analógicas tipo Box.", icon: "fa-vr-cardboard" },
                { name: "Velocidrone", type: "Software", desc: "El simulador para aprender.", icon: "fa-desktop" }
            ]
        };

        function toggleGear(mode) {
            const btnPro = document.getElementById('btn-pro');
            const btnBeg = document.getElementById('btn-beginner');
            
            if(mode === 'pro') {
                btnPro.classList.add('bg-red-600', 'text-white', 'shadow-md');
                btnPro.classList.remove('text-slate-500', 'hover:text-slate-900', 'dark:text-slate-400', 'dark:hover:text-white');
                btnBeg.classList.remove('bg-red-600', 'text-white', 'shadow-md');
                btnBeg.classList.add('text-slate-500', 'hover:text-slate-900', 'dark:text-slate-400', 'dark:hover:text-white');
            } else {
                btnBeg.classList.add('bg-red-600', 'text-white', 'shadow-md');
                btnBeg.classList.remove('text-slate-500', 'hover:text-slate-900', 'dark:text-slate-400', 'dark:hover:text-white');
                btnPro.classList.remove('bg-red-600', 'text-white', 'shadow-md');
                btnPro.classList.add('text-slate-500', 'hover:text-slate-900', 'dark:text-slate-400', 'dark:hover:text-white');
            }
            renderGear(mode);
        }

        function renderGear(mode) {
            const container = document.getElementById('gear-grid');
            if(container) {
                container.innerHTML = '';
                gearData[mode].forEach(item => {
                    const card = document.createElement('div');
                    card.className = "bg-white dark:bg-dark-card p-8 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-md hover:shadow-xl transition-all duration-300 hover:-translate-y-2 flex flex-col items-center text-center fade-in group";
                    card.innerHTML = `
                        <div class="w-20 h-20 bg-slate-50 dark:bg-slate-700 rounded-full flex items-center justify-center text-slate-700 dark:text-slate-300 mb-6 group-hover:bg-red-600 group-hover:text-white transition-colors duration-300">
                            <i class="fas ${item.icon} text-3xl"></i>
                        </div>
                        <h3 class="font-bold text-xl text-slate-900 dark:text-white font-teko uppercase tracking-wide">${item.name}</h3>
                        <span class="text-[10px] uppercase text-red-500 font-bold mb-3 tracking-widest">${item.type}</span>
                        <p class="text-slate-600 dark:text-slate-400 text-sm font-light mb-6 leading-relaxed">${item.desc}</p>
                        <button class="mt-auto text-xs font-bold text-slate-900 dark:text-slate-300 border-b-2 border-slate-200 dark:border-slate-600 hover:border-red-600 dark:hover:border-red-500 hover:text-red-600 dark:hover:text-red-500 uppercase tracking-widest transition-all pb-1">Ver en tienda</button>
                    `;
                    container.appendChild(card);
                });
            }
        }

        // --- FLIGHT TIME CALCULATOR ---
        function calculateFlightTime() {
            const mah = parseFloat(document.getElementById('calc-mah').value) || 0;
            const style = document.getElementById('calc-style').value;
            const resultEl = document.getElementById('calc-result');

            if (mah <= 0) {
                resultEl.innerText = "0:00";
                return;
            }

            let consumptionRate = 0; 
            switch (style) {
                case 'cinematic': consumptionRate = 1300 / 7; break;
                case 'freestyle': consumptionRate = 1300 / 4; break;
                case 'racing': consumptionRate = 1300 / 2.5; break;
                default: consumptionRate = 300;
            }

            const usableCapacity = mah * 0.8;
            const totalMinutes = usableCapacity / consumptionRate;
            const mins = Math.floor(totalMinutes);
            const secs = Math.floor((totalMinutes - mins) * 60);
            const formattedSecs = secs < 10 ? `0${secs}` : secs;
            
            resultEl.innerText = `${mins}:${formattedSecs}`;
            resultEl.style.transform = "scale(1.1)";
            setTimeout(() => resultEl.style.transform = "scale(1)", 200);
        }

        // --- FAQ TOGGLE ---
        function toggleFaq(button) {
            const content = button.nextElementSibling;
            const icon = button.querySelector('i');
            if (content.classList.contains('hidden')) {
                content.classList.remove('hidden');
                icon.classList.add('rotate-180');
            } else {
                content.classList.add('hidden');
                icon.classList.remove('rotate-180');
            }
        }

        // --- COUPONS ---
        const coupons = [
            { store: "Banggood", prod: "RC General", discount: "10%", code: "FPV10" },
            { store: "BetaFPV", prod: "Meteor", discount: "5%", code: "METEOR5" },
            { store: "Radiomaster", prod: "Boxer", discount: "12%", code: "RMBOX" }
        ];

        const tbody = document.getElementById('couponTableBody');
        coupons.forEach(c => {
            tbody.innerHTML += `
                <tr class="hover:bg-slate-50 dark:hover:bg-slate-700/50">
                    <td class="px-6 py-4 font-bold dark:text-white">${c.store}</td>
                    <td class="px-6 py-4 dark:text-slate-300">${c.prod}</td>
                    <td class="px-6 py-4 text-red-500 font-bold">${c.discount}</td>
                    <td class="px-6 py-4 text-right">
                        <button onclick="navigator.clipboard.writeText('${c.code}'); showToast('Copiado', 'success')" class="bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 px-3 py-1 rounded text-xs font-mono hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-500 transition">
                            ${c.code} <i class="fas fa-copy ml-1"></i>
                        </button>
                    </td>
                </tr>
            `;
        });

        // --- UTILS ---
        function showToast(msg, type) {
            const t = document.createElement('div');
            t.className = `toast ${type}`;
            t.innerText = msg;
            document.getElementById('toast-container').appendChild(t);
            setTimeout(() => t.remove(), 3000);
        }

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({behavior: 'smooth'});
        }

        // Scroll Progress & Reveal
        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('reading-progress').style.width = scrolled + "%";
            
            // Scroll top button
            const btn = document.getElementById('scroll-top-btn');
            if (winScroll > 300) btn.classList.add('visible');
            else btn.classList.remove('visible');
        });

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if(entry.isIntersecting) entry.target.classList.add('active');
            });
        });
        document.querySelectorAll('.reveal').forEach(el => observer.observe(el));

        // Init
        cookieManager.init(); // Initialize advanced cookie manager
        toggleGear('pro'); 
        updateLatestVideo(); 
    </script>
</body>
</html>