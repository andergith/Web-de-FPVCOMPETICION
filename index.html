<!DOCTYPE html>
<html lang="es" class="scroll-smooth dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPV DRONES | Web Oficial</title>
    <meta name="description" content="Web oficial del canal FPV COMPETICION - DRONES. Tutoriales de montaje, reviews honestas, simuladores y la mejor comunidad de FPV en español.">
    <!-- Meta robots para control legal -->
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook / WhatsApp -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://fpv-drones.es/">
    <meta property="og:title" content="FPV DRONES | No vueles el drone, SÉ el drone">
    <meta property="og:description" content="Tutoriales, builds, simuladores y la comunidad más cañera de FPV en español.">
    <meta property="og:image" content="https://fpv-drones.es/imagenes/social-share.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://fpv-drones.es/">
    <meta property="twitter:title" content="FPV DRONES | Web Oficial">
    <meta property="twitter:description" content="Tutoriales, builds, simuladores y la comunidad más cañera de FPV en español.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Configuración Tailwind -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#dc2626',
                        dark: {
                            bg: '#0f172a',
                            card: '#1e293b',
                            border: '#334155'
                        },
                        telegram: '#229ED9'
                    },
                    fontFamily: {
                        teko: ['Teko', 'sans-serif'],
                        inter: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@300;400;600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            transition-property: color, background-color, border-color;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 300ms;
        }

        h1, h2, h3, h4, .font-teko {
            font-family: 'Teko', sans-serif;
            text-transform: uppercase;
        }

        #reading-progress {
            position: fixed; top: 0; left: 0; width: 0%; height: 4px;
            background: linear-gradient(90deg, #dc2626, #ef4444); z-index: 100;
            transition: width 0.1s ease-out;
        }

        /* YouTube Facade */
        .video-facade {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000; background-size: cover; background-position: center;
            display: flex; align-items: center; justify-content: center; cursor: pointer; z-index: 20;
        }
        .play-button {
            width: 68px; height: 48px; background-color: rgba(33, 33, 33, 0.8);
            border-radius: 12px; display: flex; align-items: center; justify-content: center;
            transition: all 0.3s;
        }
        .play-button:hover { background-color: #f00; }
        .play-triangle {
            width: 0; height: 0; border-left: 20px solid white;
            border-top: 10px solid transparent; border-bottom: 10px solid transparent;
        }

        /* Section Styling */
        .section-slant { position: relative; z-index: 10; }
        .section-slant::after {
            content: ''; position: absolute; left: 0; bottom: -50px; width: 100%; height: 100px;
            background-color: inherit; transform: skewY(-2deg); transform-origin: bottom left; z-index: -1;
        }

        .hero-bg-image {
            background-color: rgba(15, 23, 42, 0.6) !important;
            background-image: radial-gradient(circle at 12px 12px, rgba(255,255,255,0.08) 1px, transparent 1px) !important;
            background-size: 20px 20px !important;
        }

        .aspect-w-16 {
            position: relative; padding-bottom: 56.25%; border-radius: 12px; overflow: hidden;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .aspect-w-16 iframe, .aspect-w-16 .video-facade {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        }

        .fade-in { animation: fadeIn 0.6s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s ease-out; }
        .reveal.active { opacity: 1; transform: translateY(0); }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }

        /* Modals */
        .modal-overlay { background-color: rgba(0, 0, 0, 0.85); backdrop-filter: blur(8px); }

        /* Toast */
        #toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px; }
        .toast {
            min-width: 250px; background-color: #1e293b; color: white; padding: 16px;
            border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); border-left: 4px solid #dc2626;
            display: flex; align-items: center; justify-content: space-between;
            animation: slideIn 0.3s ease-out;
        }
        .toast.success { border-left-color: #22c55e; }
        .toast.error { border-left-color: #ef4444; }

        /* Cookie Banner */
        #cookie-banner {
            position: fixed; bottom: 0; left: 0; right: 0;
            background-color: #0f172a; border-top: 1px solid #334155;
            padding: 1.5rem; z-index: 10000;
            transform: translateY(100%); transition: transform 0.3s ease-in-out;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.5);
        }
        #cookie-banner.show { transform: translateY(0); }

        /* Tech Diagram Styles */
        .tech-grid-bg {
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        .neon-box {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
        }
        
        .neon-box:hover {
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 25px rgba(220, 38, 38, 0.3);
            transform: translateY(-2px);
            z-index: 50;
        }

        .neon-line {
            filter: drop-shadow(0 0 2px currentColor);
            stroke-dasharray: 10;
            animation: flow 1s linear infinite;
        }
        
        @keyframes flow { from { stroke-dashoffset: 20; } to { stroke-dashoffset: 0; } }

        /* Card Hover Effects */
        .dashboard-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px -10px rgba(220, 38, 38, 0.3);
            border-color: #ef4444;
        }
    </style>
</head>
<body class="antialiased scroll-smooth bg-slate-50 text-slate-900 dark:bg-dark-bg dark:text-slate-200 transition-colors duration-300">

    <div id="reading-progress"></div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full bg-white/80 dark:bg-dark-bg/80 backdrop-blur-lg border-b border-slate-200 dark:border-slate-800 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex-shrink-0 flex items-center gap-3 cursor-pointer" onclick="scrollToSection('hero')">
                    <span class="font-teko text-3xl tracking-wide text-slate-900 dark:text-white">FPV <span class="text-red-600">DRONES</span></span>
                </div>
                
                <!-- Desktop Menu (Ordenado) -->
                <div class="hidden md:flex items-center space-x-2 lg:space-x-4 overflow-x-auto">
                    <!-- Menú con Acciones de Modal -->
                    <button onclick="openSectionModal('modal-antes-de-volar')" class="nav-link text-sm font-bold uppercase hover:text-red-600">Antes de Volar</button>
                    <button onclick="openSectionModal('modal-equipo')" class="nav-link text-sm font-bold uppercase hover:text-red-600">Equipo FPV</button>
                    <button onclick="openSectionModal('modal-guias')" class="nav-link text-sm font-bold uppercase hover:text-red-600">Guías Montaje</button>
                    <button onclick="openSectionModal('modal-foros')" class="nav-link text-sm font-bold uppercase hover:text-red-600">Foros</button>
                    
                    <!-- Enlaces de Scroll -->
                    <button onclick="scrollToSection('el-drone')" class="nav-link text-sm font-bold uppercase hover:text-red-600">El Drone</button>
                    <button onclick="scrollToSection('videos-destacados')" class="nav-link text-sm font-bold uppercase hover:text-red-600">Canal</button>
                    <button onclick="scrollToSection('blog')" class="nav-link text-sm font-bold uppercase hover:text-red-600">Noticias</button>
                    
                    <div class="h-6 w-px bg-slate-200 dark:bg-slate-700 mx-2"></div>
                    <button id="theme-toggle-desktop" class="p-2 text-slate-800 dark:text-yellow-400"><i class="fas fa-sun"></i></button>
                </div>

                <!-- Mobile Toggle -->
                <div class="flex items-center md:hidden gap-4">
                     <button id="theme-toggle-mobile" class="text-slate-800 dark:text-yellow-400"><i class="fas fa-sun"></i></button>
                     <button id="mobile-menu-btn" class="text-slate-900 dark:text-white hover:text-red-600"><i class="fas fa-bars text-2xl"></i></button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Panel -->
        <div id="mobile-menu" class="hidden md:hidden bg-white dark:bg-dark-card border-b border-slate-100 dark:border-slate-800">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 flex flex-col">
                <button onclick="openSectionModal('modal-antes-de-volar')" class="mobile-link px-3 py-2 font-bold uppercase hover:bg-slate-800 text-left">Antes de Volar</button>
                <button onclick="openSectionModal('modal-equipo')" class="mobile-link px-3 py-2 font-bold uppercase hover:bg-slate-800 text-left">Equipo FPV</button>
                <button onclick="openSectionModal('modal-guias')" class="mobile-link px-3 py-2 font-bold uppercase hover:bg-slate-800 text-left">Guías Montaje</button>
                <button onclick="openSectionModal('modal-foros')" class="mobile-link px-3 py-2 font-bold uppercase hover:bg-slate-800 text-left">Foros</button>
                <a href="#el-drone" class="mobile-link px-3 py-2 font-bold uppercase hover:bg-slate-800">El Drone</a>
                <a href="#videos-destacados" class="mobile-link px-3 py-2 font-bold uppercase hover:bg-slate-800">Canal</a>
                <a href="#blog" class="mobile-link px-3 py-2 font-bold uppercase hover:bg-slate-800">Noticias</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="hero" class="relative pt-24 pb-12 overflow-hidden hero-bg-image section-slant">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="lg:grid lg:grid-cols-12 lg:gap-16 items-center">
                <div class="sm:text-center md:max-w-2xl md:mx-auto lg:col-span-6 lg:text-left fade-in">
                    <div class="inline-flex items-center px-4 py-1.5 rounded-full border border-red-200 dark:border-red-900 bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm text-red-600 dark:text-red-400 text-xs font-bold uppercase tracking-widest mb-6 shadow-sm">
                        <span class="flex h-2 w-2 relative mr-2">
                            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                            <span class="relative inline-flex rounded-full h-2 w-2 bg-red-600"></span>
                        </span>
                        Canal Oficial
                    </div>
                    <h1 class="text-5xl tracking-tight font-extrabold text-slate-900 dark:text-white sm:text-6xl md:text-7xl font-teko leading-none">
                        NO VUELES EL DRON <span class="text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-red-500 block lg:inline">SÉ EL DRON</span>
                    </h1>
                    <p class="mt-6 text-lg text-slate-600 dark:text-slate-400 leading-relaxed">
                        En esta web queremos sumar todo lo aprendido en <strong>FPV COMPETICIÓN</strong>, el principal canal técnico de FPV en habla hispana.
                        Aquí vas a tenerlo todo para poder empezar a volar en FPV sin ningún problema ni susto. Para poder disfrutar de nuestra pasión, los <strong>DRONES FPV</strong>.
                    </p>
                    <div class="mt-8 flex flex-col sm:flex-row gap-4 sm:justify-center lg:justify-start">
                        <a href="https://youtube.com/@FPV-Drones" target="_blank" class="flex items-center justify-center px-8 py-4 border border-transparent font-bold text-white bg-red-600 rounded-lg hover:bg-red-700 transition-all shadow-lg">
                            <i class="fab fa-youtube mr-2"></i> Ir al Canal
                        </a>
                    </div>
                </div>
                <div class="mt-12 lg:mt-0 lg:col-span-6 fade-in">
                    <div class="relative mx-auto w-full max-w-lg aspect-w-16 shadow-2xl rounded-2xl border-4 border-white/50 dark:border-slate-700/50 bg-slate-900">
                        <div id="video-placeholder" class="video-facade" data-video-id="vHc5jnxkuzg" onclick="loadYoutubeVideo(this)">
                            <div class="play-button"><div class="play-triangle"></div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION: DASHBOARD RESUMEN -->
    <section id="dashboard-resumen" class="py-12 bg-slate-100 dark:bg-slate-900/50 -mt-10 relative z-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <!-- Card 1 -->
                <div onclick="openSectionModal('modal-antes-de-volar')" class="dashboard-card bg-white dark:bg-slate-800 p-6 rounded-xl border border-slate-200 dark:border-slate-700 flex flex-col items-center text-center">
                    <div class="w-14 h-14 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center text-red-600 mb-4">
                        <i class="fas fa-book-reader text-2xl"></i>
                    </div>
                    <h3 class="font-teko text-2xl font-bold dark:text-white">Antes de Volar</h3>
                    <p class="text-xs text-slate-500 mt-2">Legalidad, Simuladores y primeros pasos.</p>
                </div>
                <!-- Card 2 -->
                <div onclick="openSectionModal('modal-equipo')" class="dashboard-card bg-white dark:bg-slate-800 p-6 rounded-xl border border-slate-200 dark:border-slate-700 flex flex-col items-center text-center">
                    <div class="w-14 h-14 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 mb-4">
                        <i class="fas fa-box-open text-2xl"></i>
                    </div>
                    <h3 class="font-teko text-2xl font-bold dark:text-white">Equipo FPV</h3>
                    <p class="text-xs text-slate-500 mt-2">Gafas, Emisoras y Ofertas destacadas.</p>
                </div>
                <!-- Card 3 -->
                <div onclick="openSectionModal('modal-guias')" class="dashboard-card bg-white dark:bg-slate-800 p-6 rounded-xl border border-slate-200 dark:border-slate-700 flex flex-col items-center text-center">
                    <div class="w-14 h-14 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center text-yellow-600 mb-4">
                        <i class="fas fa-tools text-2xl"></i>
                    </div>
                    <h3 class="font-teko text-2xl font-bold dark:text-white">Guías Montaje</h3>
                    <p class="text-xs text-slate-500 mt-2">Esquemas, wiring y configuraciones.</p>
                </div>
                <!-- Card 4 -->
                <div onclick="openSectionModal('modal-foros')" class="dashboard-card bg-white dark:bg-slate-800 p-6 rounded-xl border border-slate-200 dark:border-slate-700 flex flex-col items-center text-center">
                    <div class="w-14 h-14 rounded-full bg-sky-100 dark:bg-sky-900/30 flex items-center justify-center text-sky-600 mb-4">
                        <i class="fab fa-telegram text-3xl pl-1"></i>
                    </div>
                    <h3 class="font-teko text-2xl font-bold dark:text-white">Comunidad</h3>
                    <p class="text-xs text-slate-500 mt-2">Grupos de ayuda y compra/venta.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION: EL DRONE -->
    <section id="el-drone" class="py-12 bg-white dark:bg-dark-bg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-10">
                <h2 class="text-4xl font-bold text-slate-900 dark:text-white font-teko">El Drone</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Tinywhoop -->
                <div class="bg-slate-50 dark:bg-slate-800/40 rounded-2xl p-4 border border-slate-200 dark:border-slate-700">
                     <h3 class="text-2xl font-teko font-bold text-slate-900 dark:text-white mb-2">Tinywhoops y Toothpicks</h3>
                     <div class="w-full relative pt-[56.25%] overflow-hidden rounded-lg bg-black">
                        <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/videoseries?si=eck6678Hx6oFtoW-&amp;list=PL_AS-7inzwYqVA3-vnpi8UPkczyvjwLMx" frameborder="0" allowfullscreen loading="lazy"></iframe>
                    </div>
                </div>
                <!-- Cinewhoops -->
                <div class="bg-slate-50 dark:bg-slate-800/40 rounded-2xl p-4 border border-slate-200 dark:border-slate-700">
                    <h3 class="text-2xl font-teko font-bold text-slate-900 dark:text-white mb-2">Cinewhoops</h3>
                    <div class="w-full relative pt-[56.25%] overflow-hidden rounded-lg bg-black">
                        <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/videoseries?si=ykGZUsZSKc7YfzE_&amp;list=PL_AS-7inzwYr0TXJtNEP2nM_a-FnluZvW" frameborder="0" allowfullscreen loading="lazy"></iframe>
                    </div>
                </div>
                 <!-- Freestyle/Racing -->
                <div class="md:col-span-2 bg-slate-50 dark:bg-slate-800/40 rounded-2xl p-4 border border-slate-200 dark:border-slate-700">
                    <div class="flex flex-col md:flex-row gap-6">
                        <div class="flex-1">
                            <h3 class="text-3xl font-teko font-bold text-slate-900 dark:text-white mb-2">Freestyle & Racing</h3>
                            <p class="text-sm text-slate-600 dark:text-slate-300">La modalidad reina. Acrobacias y velocidad.</p>
                        </div>
                        <div class="w-full md:w-1/2 relative pt-[28%] bg-black rounded-lg overflow-hidden">
                             <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/videoseries?si=LvqFpM8JePF_YMum&amp;list=PL_AS-7inzwYqjw7I4ZkN5MCZoVfoBAkfN" frameborder="0" allowfullscreen loading="lazy"></iframe>
                        </div>
                    </div>
                </div>
                <!-- Long Range -->
                 <div class="bg-slate-50 dark:bg-slate-800/40 rounded-2xl p-4 border border-slate-200 dark:border-slate-700">
                    <h3 class="text-2xl font-teko font-bold text-slate-900 dark:text-white mb-2">Long Range</h3>
                    <div class="w-full relative pt-[56.25%] overflow-hidden rounded-lg bg-black">
                        <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/videoseries?si=ox9iv8kcrMbWkHhb&amp;list=PL_AS-7inzwYo1BD9xB0UAS0bzfrErU96q" frameborder="0" allowfullscreen loading="lazy"></iframe>
                    </div>
                </div>
                <!-- DJI -->
                 <div class="bg-slate-50 dark:bg-slate-800/40 rounded-2xl p-4 border border-slate-200 dark:border-slate-700 text-center flex flex-col justify-center">
                    <h3 class="text-3xl font-teko font-bold text-slate-900 dark:text-white mb-2">DJI</h3>
                    <p class="text-sm text-slate-600 dark:text-slate-300 mb-4">Digital HD, fácil y seguro.</p>
                    <a href="https://www.youtube.com/@FPV-Drones/search?query=dji" target="_blank" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition text-sm">Ver Vídeos</a>
                </div>
                <!-- Stabilized -->
                <div class="md:col-span-2 bg-slate-50 dark:bg-slate-800/40 rounded-2xl p-4 border border-slate-200 dark:border-slate-700">
                     <div class="flex flex-col md:flex-row gap-6">
                        <div class="flex-1">
                            <h3 class="text-3xl font-teko font-bold text-slate-900 dark:text-white mb-2">Estabilizados</h3>
                            <p class="text-sm text-slate-600 dark:text-slate-300 mb-4">Fotografía tradicional.</p>
                        </div>
                        <div class="w-full md:w-1/2 relative pt-[28%] bg-black rounded-lg overflow-hidden">
                             <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/videoseries?si=le52ATFYDiIny_0k&amp;list=PL_AS-7inzwYr6pEu2eY-I35oUhlUSkXT_" frameborder="0" allowfullscreen loading="lazy"></iframe>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION: HERRAMIENTAS (After Guides) -->
    <section id="herramientas" class="py-12 bg-slate-50 dark:bg-dark-card relative">
        <div class="max-w-6xl mx-auto px-4">
            <h2 class="text-4xl font-bold text-slate-900 dark:text-white font-teko text-center mb-10">Herramientas de Vuelo</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <!-- Flight Time -->
                <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-8 border border-slate-200 dark:border-slate-700">
                    <h3 class="text-2xl font-bold text-slate-900 dark:text-white font-teko mb-6"><i class="fas fa-stopwatch text-red-600"></i> Tiempo de Vuelo</h3>
                    <div class="space-y-4">
                        <input type="number" id="calc-mah" value="1300" class="w-full rounded-lg border p-2 bg-slate-100 dark:bg-slate-900 dark:text-white">
                        <button onclick="calculateFlightTime()" class="bg-slate-900 dark:bg-white text-white dark:text-slate-900 font-bold py-2 px-6 rounded-lg w-full">Calcular</button>
                        <div class="text-right"><span id="calc-result" class="text-4xl font-teko font-bold text-red-600">0:00</span> min</div>
                    </div>
                </div>
                <!-- Lipo Charge -->
                <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-xl p-8 border border-slate-200 dark:border-slate-700">
                    <h3 class="text-2xl font-bold text-slate-900 dark:text-white font-teko mb-6"><i class="fas fa-bolt text-blue-500"></i> Carga LiPo</h3>
                    <div class="flex gap-2 mb-4">
                        <input type="number" id="lipo-mah" value="1300" class="w-1/2 rounded-lg border p-2 bg-slate-100 dark:bg-slate-900 dark:text-white" placeholder="mAh">
                        <input type="number" id="lipo-count" value="4" class="w-1/4 rounded-lg border p-2 bg-slate-100 dark:bg-slate-900 dark:text-white" placeholder="N">
                        <select id="lipo-c" class="w-1/4 rounded-lg border p-2 bg-slate-100 dark:bg-slate-900 dark:text-white"><option value="1">1C</option><option value="2">2C</option></select>
                    </div>
                    <button onclick="calculateLipoCharge()" class="w-full bg-blue-600 text-white font-bold py-2 px-6 rounded-lg">Calcular</button>
                    <div class="text-right mt-2"><span id="lipo-result" class="text-4xl font-teko font-bold text-blue-500">0.0</span> Amps</div>
                </div>
            </div>
        </div>
    </section>

    <!-- SECTION: CANAL (Videos) -->
    <section id="videos-destacados" class="py-12 bg-white dark:bg-dark-bg">
        <div class="max-w-7xl mx-auto px-4">
             <div class="flex justify-between items-center mb-8">
                <h2 class="text-4xl font-bold dark:text-white font-teko">Canal</h2>
                <a href="https://www.youtube.com/@FPV-Drones/videos" target="_blank" class="text-red-600 font-bold text-sm">Ver Todo -></a>
            </div>
            <div id="latest-videos-grid" class="grid md:grid-cols-3 gap-6"></div>
        </div>
    </section>

    <!-- SECTION: BLOG -->
    <section id="blog" class="py-12 bg-slate-50 dark:bg-slate-900">
        <div class="max-w-7xl mx-auto px-4">
             <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold dark:text-white font-teko">Blog Noticias</h2>
                <button onclick="toggleAdminPanel()" class="text-slate-400 hover:text-white"><i class="fas fa-lock"></i></button>
            </div>
            <div id="blog-posts-container" class="grid md:grid-cols-3 gap-6"></div>
        </div>
    </section>

    <!-- SECTION: SERVICIOS -->
    <section id="servicios" class="py-12 bg-slate-100 dark:bg-dark-card border-t border-slate-200 dark:border-slate-800">
        <div class="max-w-md mx-auto text-center px-4">
            <h2 class="text-3xl font-bold dark:text-white font-teko mb-4">Servicios Profesionales</h2>
            <div class="bg-white dark:bg-slate-800 p-6 rounded-xl shadow border border-slate-100 dark:border-slate-700">
                    <i class="fas fa-video text-4xl text-red-600 mb-4"></i>
                    <h3 class="text-xl font-bold dark:text-white">FPV Cinema</h3>
                    <p class="text-xs text-slate-500 mb-4">Grabación profesional 5K para eventos y publicidad.</p>
                    <button onclick="openContactModal('FPV Cinema')" class="w-full bg-slate-900 text-white py-2 rounded font-bold hover:bg-slate-700 text-sm">Pedir Presupuesto</button>
            </div>
        </div>
    </section>

    <!-- FAQ -->
    <section id="faq" class="py-12 bg-slate-50 dark:bg-dark-card">
         <div class="max-w-3xl mx-auto px-4">
            <h2 class="text-4xl font-bold text-slate-900 dark:text-white font-teko text-center mb-10">FAQ</h2>
            <div class="space-y-4">
                <div class="border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden">
                    <button class="flex items-center justify-between w-full p-4 bg-white dark:bg-slate-800 text-left font-bold text-slate-900 dark:text-white focus:outline-none" onclick="toggleFaq(this)">
                        <span>¿Necesito licencia?</span>
                        <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div class="hidden p-4 bg-slate-50 dark:bg-slate-900 text-slate-600 dark:text-slate-400 text-sm">Sí, registro en AESA como operador es obligatorio incluso para drones de menos de 250g si tienen cámara.</div>
                </div>

                <div class="border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden">
                    <button class="flex items-center justify-between w-full p-4 bg-white dark:bg-slate-800 text-left font-bold text-slate-900 dark:text-white focus:outline-none" onclick="toggleFaq(this)">
                        <span>¿Qué compro para empezar?</span>
                        <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div class="hidden p-4 bg-slate-50 dark:bg-slate-900 text-slate-600 dark:text-slate-400 text-sm">
                        Lo mejor es empezar solo con una emisora (mando) barata como la Radiomaster Pocket y echarle horas al simulador (Velocidrone o Liftoff) antes de gastar dinero en el drone.
                    </div>
                </div>

                <div class="border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden">
                    <button class="flex items-center justify-between w-full p-4 bg-white dark:bg-slate-800 text-left font-bold text-slate-900 dark:text-white focus:outline-none" onclick="toggleFaq(this)">
                        <span>¿Analógico o Digital?</span>
                        <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div class="hidden p-4 bg-slate-50 dark:bg-slate-900 text-slate-600 dark:text-slate-400 text-sm">
                        <strong>Digital (DJI/Walksnail):</strong> Calidad de imagen increíble, experiencia inmersiva, pero más caro. <br>
                        <strong>Analógico:</strong> Imagen con interferencias ("niebla"), pero muy barato, ligero y latencia ultra baja. Ideal para empezar con presupuesto ajustado.
                    </div>
                </div>

                <div class="border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden">
                    <button class="flex items-center justify-between w-full p-4 bg-white dark:bg-slate-800 text-left font-bold text-slate-900 dark:text-white focus:outline-none" onclick="toggleFaq(this)">
                        <span>¿Cuánto cuesta un equipo completo?</span>
                        <i class="fas fa-chevron-down transform transition-transform duration-300"></i>
                    </button>
                    <div class="hidden p-4 bg-slate-50 dark:bg-slate-900 text-slate-600 dark:text-slate-400 text-sm">
                        Un kit de iniciación (Tinywhoop RTF) ronda los 200-300€. Un equipo profesional de 5 pulgadas con sistema digital y gafas buenas puede irse a los 1000€-1500€ fácilmente.
                    </div>
                </div>
            </div>
         </div>
    </section>

    <!-- LARGE MODALS PARA LAS SECCIONES -->
    
    <!-- MODAL 1: ANTES DE VOLAR -->
    <div id="modal-antes-de-volar" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-slate-50 dark:bg-slate-900 w-full max-w-6xl h-[90vh] rounded-2xl relative overflow-hidden flex flex-col shadow-2xl border border-slate-200 dark:border-slate-700">
            <!-- Header -->
            <div class="p-6 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center">
                <h2 class="text-3xl font-bold font-teko dark:text-white">Antes de Volar</h2>
                <button onclick="closeSectionModal('modal-antes-de-volar')" class="text-slate-400 hover:text-red-500 transition"><i class="fas fa-times text-2xl"></i></button>
            </div>
            <!-- Scrollable Content -->
            <div class="overflow-y-auto p-6 md:p-10">
                <div class="bg-white dark:bg-slate-800 rounded-2xl p-8 shadow-lg border border-slate-200 dark:border-slate-700 min-h-[300px] tab-container">
                    <!-- Tabs -->
                    <div class="flex justify-center mb-8">
                        <div class="inline-flex bg-slate-100 dark:bg-slate-900 p-1 rounded-xl">
                            <button class="tab-btn active px-6 py-2 rounded-lg font-teko text-xl text-white bg-slate-900 dark:bg-red-600 shadow-sm" onclick="switchTab('phase1', this)">Legalidad</button>
                            <button class="tab-btn px-6 py-2 rounded-lg font-teko text-xl text-slate-500 dark:text-slate-400" onclick="switchTab('phase2', this)">Simulador</button>
                            <button class="tab-btn px-6 py-2 rounded-lg font-teko text-xl text-slate-500 dark:text-slate-400" onclick="switchTab('phase3', this)">Betaflight</button>
                        </div>
                    </div>
                    <!-- Content -->
                    <div>
                        <!-- FASE 1: LEGALIDAD (Contenido Actualizado del Cliente) -->
                        <div id="phase1" class="tab-content fade-in">
                            <div class="space-y-6 text-left text-sm text-slate-600 dark:text-slate-300">
                                
                                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-800">
                                    <p class="mb-2"><strong>¡Ojo!</strong> Incluso si tu drone pesa <strong>menos de 250g</strong>, al tener una cámara que registra datos del entorno (el vídeo) deja de considerarse juguete y pasa a ser <strong>aeronave</strong> a ojos de la ley.</p>
                                    <p>Básicamente: regístrate si tienes cámara, revisa el mapa de Enaire y respeta alturas/distancias. Más info en <a href="https://www.seguridadaerea.gob.es/es/ambitos/drones/tienes-un-uas-dron" target="_blank" class="text-blue-500 hover:underline">AESA</a>.</p>
                                </div>

                                <div class="grid md:grid-cols-2 gap-6">
                                    <div>
                                        <h4 class="font-bold text-slate-900 dark:text-white mb-2">1. Sentido Común</h4>
                                        <p>Aunque vueles legalmente, plantéate si molestas o asustas a animales. Evita conflictos innecesarios.</p>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-slate-900 dark:text-white mb-2">2. Registro Operador</h4>
                                        <p>Obligatorio en <a href="https://sede.seguridadaerea.gob.es/" target="_blank" class="text-blue-500 hover:underline">AESA</a>. Pega tu número de operador visible en el drone.</p>
                                    </div>
                                    <div class="md:col-span-2">
                                        <h4 class="font-bold text-slate-900 dark:text-white mb-2">3. ¿Dónde Volar?</h4>
                                        <p><strong>PROHIBIDO:</strong> Aglomeraciones, playas con gente, aeropuertos, helipuertos, zonas militares y protegidas.</p>
                                        <p><strong>Zonas Urbanas:</strong> Posible solo en algunos casos <u>previa notificación al Ministerio del Interior</u>.</p>
                                        <p class="mt-2"><a href="https://drones.enaire.es/" target="_blank" class="text-blue-500 hover:underline font-bold">Consultar Mapa ENAIRE</a>, mapa oficial donde se indican las restricciones de cada zona.</p>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-slate-900 dark:text-white mb-2">4. Reglas de Vuelo</h4>
                                        <ul class="list-disc pl-5 space-y-1">
                                            <li>Siempre a la vista (VLOS) o con observador.</li>
                                            <li>Altura máx: <strong>120m</strong> (menos en CTR/noche).</li>
                                            <li>Distancia máx: <strong>500m</strong>.</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h4 class="font-bold text-slate-900 dark:text-white mb-2">5. Potencias (CE)</h4>
                                        <ul class="space-y-1 text-xs">
                                            <li><strong>5.8 GHz:</strong> &lt;25 mW (Estándar FPV).</li>
                                            <li><strong>5.1 GHz:</strong> Usado en nuevos sistemas digitales (O4).</li>
                                            <li><strong>2.4 GHz:</strong> &lt;100 mW.</li>
                                            <li><strong>868 MHz:</strong> Permitido en EU (Control largo alcance).</li>
                                        </ul>
                                    </div>
                                </div>

                                <!-- Categoría Abierta Info -->
                                <div class="bg-slate-100 dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-700 mt-4">
                                    <h4 class="font-bold text-slate-900 dark:text-white mb-3">Categoría Abierta (Drones > 250g)</h4>
                                    <div class="grid sm:grid-cols-3 gap-4 text-xs">
                                        <div class="p-2 bg-white dark:bg-slate-800 rounded shadow-sm">
                                            <strong class="block text-red-500 mb-1">A1 (&lt;900g)</strong>
                                            Sobrevuelo disperso. Curso+Examen.
                                        </div>
                                        <div class="p-2 bg-white dark:bg-slate-800 rounded shadow-sm">
                                            <strong class="block text-red-500 mb-1">A2 (&lt;4kg)</strong>
                                            Cerca de personas (30m/5m). Examen teórico extra.
                                        </div>
                                        <div class="p-2 bg-white dark:bg-slate-800 rounded shadow-sm">
                                            <strong class="block text-red-500 mb-1">A3 (&lt;25kg)</strong>
                                            Lejos de todo (150m). Curso+Examen.
                                        </div>
                                    </div>
                                </div>

                                <div class="bg-red-50 dark:bg-red-900/20 p-4 rounded text-center text-red-600 dark:text-red-400 font-bold text-xs mt-6">
                                    ¡Ojo con las multas! Son reales y cuantiosas. Vuela legal.
                                </div>

                                <!-- Texto Legal Completo (Pegado directamente) -->
                                <div class="mt-8 pt-8 border-t border-slate-200 dark:border-slate-700 prose dark:prose-invert max-w-none text-slate-600 dark:text-slate-400 text-sm leading-relaxed">
                                    <h3 class="text-2xl font-teko font-bold text-slate-900 dark:text-white mb-4">Información Detallada</h3>
                                    
                                    <p>Aunque te recomiendo que visites la página de AESA dedicada a este punto para una mayor información (<a href="https://www.seguridadaerea.gob.es/es/ambitos/drones/tienes-un-uas-dron" target="_blank" class="text-red-500 hover:underline">Web AESA</a>), estas son algunas pautas detalladas que tienes que tener en cuenta:</p>

                                    <h4 class="font-bold text-slate-900 dark:text-white mt-6 mb-2 text-lg">1. Ten un poco de sentido común</h4>
                                    <p>Incluso si vas a volar un pequeño dron en el campo donde no tengas ningún problema legal para hacerlo, plantéate si vas a molestar a alguien o puedes asustar a algún animal. Puedes tener todo el derecho del mundo a volar, pero es mejor no crear conflictos innecesarios y problemas.</p>

                                    <h4 class="font-bold text-slate-900 dark:text-white mt-6 mb-2 text-lg">2. Cumple la ley</h4>
                                    <p>Dado que tu drone lleva cámara, tienes que registrarte como operador en AESA (Agencia Estatal de Seguridad Aérea). Este registro es gratuito y se hace online en la siguiente dirección: <a href="https://sede.seguridadaerea.gob.es/" target="_blank" class="text-blue-500 hover:underline">Sede Electrónica AESA</a></p>
                                    <p>Tienes que poner de forma visible el <strong>número de operador</strong> que se te asigne en el dron. Puedes ponerlo en una etiqueta, pegatina o escrito/grabado directamente en el dron (no hace falta que sea ignífugo). Te recomiendo indicar también tu número de teléfono (si pierdes el dron igual alguien te lo devuelve, no sería el primer caso).</p>

                                    <h4 class="font-bold text-slate-900 dark:text-white mt-6 mb-2 text-lg">3. Analiza dónde vas a volar</h4>
                                    <p>Cuidado, aunque tu drone te parezca casi de juguete y muy pequeño, no puedes volar en cualquier sitio. Tanto por tu bien como por el de los demás:</p>
                                    <ul class="list-disc pl-5 space-y-1">
                                        <li>No se puede volar sobre <strong>zonas urbanas</strong> (salvo notificación al Ministerio del Interior), <strong>aglomeraciones de personas</strong>, <strong>playas concurridas</strong> ni cerca de gente sin cumplir requisitos adicionales.</li>
                                        <li>Está prohibido volar cerca de <strong>aeropuertos</strong>, <strong>helipuertos</strong>, <strong>instalaciones militares</strong>, <strong>infraestructuras críticas</strong> y en muchos <strong>espacios naturales protegidos</strong>.</li>
                                    </ul>
                                    <p class="mt-2">Para saber si una zona es apta, hay que consultar siempre el mapa oficial de <strong>ENAIRE Drones</strong>: <a href="https://drones.enaire.es/" target="_blank" class="text-blue-500 hover:underline">drones.enaire.es</a>. Tienes una aplicación para IOS o Android de Enaire Drones gratuita.</p>

                                    <h4 class="font-bold text-slate-900 dark:text-white mt-6 mb-2 text-lg">4. Cómo volar</h4>
                                    <ul class="list-disc pl-5 space-y-1">
                                        <li>El dron debe mantenerse <strong>siempre dentro del alcance visual</strong> del piloto (VLOS).</li>
                                        <li>La <strong>altura máxima</strong> que puedes pillar es de <strong>120 metros</strong> sobre el terreno (o menos si estás en zona CTR o de noche según restricciones).</li>
                                        <li>La <strong>distancia máxima</strong> a la que te puedes alejar en categoría abierta es de <strong>500m</strong> o hasta que el observador vaya a perder de vista el drone (lo primero que suceda).</li>
                                    </ul>

                                    <h4 class="font-bold text-slate-900 dark:text-white mt-6 mb-2 text-lg">5. Recuerda las potencias máximas</h4>
                                    <div class="bg-slate-100 dark:bg-slate-800 p-4 rounded-lg my-4 border border-slate-200 dark:border-slate-700">
                                        <ul class="space-y-2">
                                            <li><strong class="text-blue-600 dark:text-blue-400">5.8 GHz (Vídeo):</strong> &lt;25 mW (14 dBm). Estándar en Europa.</li>
                                            <li><strong class="text-blue-600 dark:text-blue-400">2.4 GHz (Control/Vídeo):</strong> &lt;100 mW (20 dBm).</li>
                                            <li><strong class="text-blue-600 dark:text-blue-400">868 MHz (Control Largo Alcance):</strong> Permitido en la UE sin necesidad de permiso especial en las bandas libres (hasta ciertas potencias como 25mW, para más potencia se aplican otras normativas de radioaficionado).</li>
                                            <li><strong class="text-blue-600 dark:text-blue-400">5.1 GHz:</strong> Usado en sistemas modernos digitales.</li>
                                        </ul>
                                    </div>

                                    <h4 class="font-bold text-slate-900 dark:text-white mt-6 mb-2 text-lg">6. Personas y privacidad</h4>
                                    <p>Llevas una cámara que seguramente está grabando, por lo que hay que cumplir con la LOPD. Básicamente no se pueden grabar personas reconocibles sin su consentimiento. Tienes que que respetar viviendas, propiedades privadas y espacios íntimos.</p>

                                    <h4 class="font-bold text-slate-900 dark:text-white mt-6 mb-2 text-lg">7. Seguro</h4>
                                    <p>Para uso recreativo no siempre es obligatorio (no con menos de 250g), pero <strong>es muy recomendable</strong> tener un seguro de responsabilidad civil. Hay algunos muy baratos que pueden cubrirte ante imprevistos:</p>
                                    <ul class="list-disc pl-5 space-y-1">
                                        <li><a href="https://www.coverdrone.com/es/" target="_blank" class="text-blue-500 hover:underline">Coverdrone</a></li>
                                        <li><a href="https://www.air-assurances.es/" target="_blank" class="text-blue-500 hover:underline">Air Assurances</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- FASE 2: SIMULADOR (Actualizado) -->
                        <div id="phase2" class="tab-content hidden fade-in">
                            <div class="space-y-8">
                                <!-- Destacado TRYP -->
                                <div class="bg-slate-900 rounded-xl overflow-hidden shadow-2xl border border-slate-700">
                                    <div class="w-full relative pt-[56.25%] bg-black">
                                        <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/3eNxmMHUEL8?si=C9X9VNmHC1B_s93t" frameborder="0" allowfullscreen loading="lazy"></iframe>
                                    </div>
                                    <div class="p-6">
                                        <div class="flex items-center gap-3 mb-2">
                                            <h3 class="text-2xl font-bold text-white font-teko">TRYP FPV</h3>
                                            <span class="bg-yellow-500 text-black text-xs font-bold px-2 py-1 rounded uppercase">Recomendado</span>
                                        </div>
                                        <p class="text-slate-300 text-sm">El simulador más completo, con mapas muy abiertos y posibilidad de hacer tipos muy diferentes de vuelos.</p>
                                    </div>
                                </div>

                                <!-- Grid Otros -->
                                <div class="grid md:grid-cols-3 gap-6">
                                    <!-- Velocidrone -->
                                    <div class="bg-white dark:bg-slate-800 rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700 shadow-lg">
                                        <div class="h-32 bg-slate-200 dark:bg-slate-700 flex items-center justify-center">
                                            <span class="font-teko text-4xl text-slate-400">VELOCIDRONE</span>
                                        </div>
                                        <div class="p-4">
                                            <h4 class="font-bold dark:text-white">Velocidrone</h4>
                                            <p class="text-xs text-slate-500 mt-1">El rey de la competición. Físicas puras para ganar carreras.</p>
                                        </div>
                                    </div>
                                    <!-- Liftoff -->
                                    <div class="bg-white dark:bg-slate-800 rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700 shadow-lg">
                                        <div class="h-32 bg-slate-200 dark:bg-slate-700 flex items-center justify-center">
                                            <span class="font-teko text-4xl text-slate-400">LIFTOFF</span>
                                        </div>
                                        <div class="p-4">
                                            <h4 class="font-bold dark:text-white">Liftoff</h4>
                                            <p class="text-xs text-slate-500 mt-1">Equilibrio perfecto. Gran comunidad y taller de personalización.</p>
                                        </div>
                                    </div>
                                    <!-- Uncrashed -->
                                    <div class="bg-white dark:bg-slate-800 rounded-xl overflow-hidden border border-slate-200 dark:border-slate-700 shadow-lg">
                                        <div class="h-32 bg-slate-200 dark:bg-slate-700 flex items-center justify-center">
                                            <span class="font-teko text-4xl text-slate-400">UNCRASHED</span>
                                        </div>
                                        <div class="p-4">
                                            <h4 class="font-bold dark:text-white">Uncrashed</h4>
                                            <p class="text-xs text-slate-500 mt-1">Gráficos increíbles para persecuciones y vuelos cinemáticos.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- FASE 3: BETAFLIGHT (Video) -->
                        <div id="phase3" class="tab-content hidden fade-in">
                            <div class="max-w-3xl mx-auto text-center">
                                <h3 class="text-2xl font-bold dark:text-white mb-4 font-teko">Configuración Básica</h3>
                                <div class="w-full relative pt-[56.25%] overflow-hidden rounded-xl bg-black shadow-2xl border border-slate-700 mb-4">
                                    <iframe class="absolute top-0 left-0 w-full h-full" src="https://www.youtube.com/embed/59GEcl9umBE?si=apxZqxFpGiKGNnZn" frameborder="0" allowfullscreen loading="lazy"></iframe>
                                </div>
                                <p class="text-slate-500 text-sm">Tutorial completo de configuración inicial para tu primer vuelo.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL 2: EQUIPO FPV -->
    <div id="modal-equipo" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-slate-50 dark:bg-slate-900 w-full max-w-6xl h-[90vh] rounded-2xl relative overflow-hidden flex flex-col shadow-2xl border border-slate-200 dark:border-slate-700">
             <!-- Header -->
             <div class="p-6 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center">
                <h2 class="text-3xl font-bold font-teko dark:text-white">Equipo FPV & Ofertas</h2>
                <button onclick="closeSectionModal('modal-equipo')" class="text-slate-400 hover:text-red-500 transition"><i class="fas fa-times text-2xl"></i></button>
            </div>
            <!-- Scrollable Content -->
            <div class="overflow-y-auto p-6 md:p-10">
                <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Equipo -->
                    <div class="bg-white dark:bg-dark-card p-6 rounded-2xl shadow-lg border border-slate-100 dark:border-slate-800">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-3xl font-bold dark:text-white font-teko">Equipo Recomendado</h2>
                            <div class="flex bg-white dark:bg-slate-900 p-1 rounded-lg shadow-sm">
                                <button id="btn-gear-pro" onclick="toggleGear('pro')" class="px-3 py-1 text-xs font-bold bg-slate-200 dark:bg-slate-700 text-slate-900 dark:text-white rounded transition">Pro</button>
                                <button id="btn-gear-beginner" onclick="toggleGear('beginner')" class="px-3 py-1 text-xs font-bold text-slate-500 hover:text-slate-900 transition">Inicio</button>
                            </div>
                        </div>
                        <div id="gear-grid" class="grid grid-cols-2 gap-4"></div>
                    </div>
                     <!-- Ofertas -->
                    <div id="ofertas-modal-content" class="bg-slate-50 dark:bg-dark-card p-6 rounded-2xl shadow-lg border border-slate-100 dark:border-slate-800">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-3xl font-bold dark:text-white font-teko">Cupones y Ofertas</h2>
                            <i class="fas fa-tags text-red-500 text-2xl"></i>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-xs text-left text-slate-500 dark:text-slate-400">
                                <tbody id="couponTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL 3: GUÍAS MONTAJE -->
    <div id="modal-guias" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-slate-900 w-full max-w-7xl h-[95vh] rounded-2xl relative overflow-hidden flex flex-col shadow-2xl border border-slate-700">
            <!-- Header (Absolute para superponerse) -->
            <button onclick="closeSectionModal('modal-guias')" class="absolute top-6 right-6 z-50 text-white hover:text-red-500 bg-black/50 p-2 rounded-full transition"><i class="fas fa-times text-2xl"></i></button>
            
            <!-- Content (Sección Completa) -->
            <div class="overflow-y-auto h-full">
                <section class="py-12 md:py-24 bg-slate-900 text-white relative overflow-hidden min-h-full">
                    <!-- Fondo Técnico -->
                    <div class="absolute inset-0 bg-gradient-to-b from-slate-900 via-slate-900 to-black z-0"></div>
                    <div class="absolute inset-0 tech-grid-bg opacity-30 z-0 pointer-events-none"></div>
                    <div class="absolute top-0 right-0 w-96 h-96 bg-red-600/10 rounded-full blur-[100px] pointer-events-none"></div>
                    <div class="absolute bottom-0 left-0 w-96 h-96 bg-blue-600/10 rounded-full blur-[100px] pointer-events-none"></div>
                    
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
                        <!-- Cabecera -->
                        <div class="mb-12 flex flex-col md:flex-row justify-between items-end border-b border-slate-700/50 pb-8">
                            <div>
                                <div class="inline-flex items-center gap-2 mb-2">
                                    <span class="flex h-2 w-2 relative">
                                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"></span>
                                        <span class="relative inline-flex rounded-full h-2 w-2 bg-red-500"></span>
                                    </span>
                                    <span class="text-red-500 font-bold tracking-widest uppercase text-xs">Proyecto del mes</span>
                                </div>
                                <h2 class="text-6xl md:text-7xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-white to-slate-400 font-teko mt-0">Freestyle 5"</h2>
                                <p class="text-slate-400 text-xl font-teko tracking-wide">Configuración: "The Bando Killer"</p>
                            </div>
                            <div class="mt-6 md:mt-0 flex gap-3">
                                <button class="bg-white hover:bg-slate-200 text-slate-900 px-6 py-3 rounded-lg text-sm font-bold uppercase transition flex items-center gap-2 shadow-[0_0_15px_rgba(255,255,255,0.2)]">
                                    <i class="fas fa-file-invoice text-red-600"></i> Lista Piezas
                                </button>
                                <button class="bg-slate-800 hover:bg-slate-700 text-white border border-slate-600 hover:border-slate-500 px-6 py-3 rounded-lg text-sm font-bold uppercase transition flex items-center gap-2">
                                    <i class="fas fa-terminal text-green-400"></i> CLI Dump
                                </button>
                            </div>
                        </div>
            
                        <!-- Diagrama -->
                        <div class="bg-slate-900/60 backdrop-blur-md rounded-3xl border border-slate-700/50 relative overflow-hidden shadow-2xl">
                            <!-- Barra superior -->
                            <div class="absolute top-0 left-0 w-full px-6 py-4 flex justify-between items-center border-b border-slate-700/30 bg-slate-900/40 z-30">
                                <span class="text-xs font-mono text-slate-500">SCHEMATIC_VIEW_V2.0</span>
                                <div class="flex gap-2">
                                    <div class="w-2 h-2 rounded-full bg-red-500/50"></div>
                                    <div class="w-2 h-2 rounded-full bg-yellow-500/50"></div>
                                    <div class="w-2 h-2 rounded-full bg-green-500/50"></div>
                                </div>
                            </div>
            
                            <!-- Canvas -->
                            <div class="relative w-full md:h-[700px] flex flex-col items-center justify-center p-6 py-16 md:p-0 gap-8 md:gap-0 mt-8">
                                <svg class="hidden md:block absolute inset-0 z-0 w-full h-full pointer-events-none" viewBox="0 0 900 700" preserveAspectRatio="none">
                                    <path class="flow-line neon-line text-cyan-400" d="M450 126 L 450 350" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="6,4" stroke-linecap="round" />
                                    <path class="flow-line neon-line text-yellow-400" d="M450 595 L 450 350" stroke="currentColor" stroke-width="3" fill="none" stroke-dasharray="8,4" stroke-linecap="round" />
                                    <path class="flow-line neon-line text-blue-500" d="M135 350 L 450 350" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="4,4" stroke-linecap="round" />
                                    <path class="flow-line neon-line text-green-500" d="M765 350 L 450 350" stroke="currentColor" stroke-width="2" fill="none" stroke-dasharray="4,4" stroke-linecap="round" />
                                </svg>
                                
                                <div class="md:hidden absolute left-1/2 top-20 bottom-20 w-0.5 bg-slate-700/50 -translate-x-1/2 z-0"></div>
            
                                <!-- Components -->
                                <div class="relative md:absolute md:top-[18%] md:left-1/2 md:transform md:-translate-x-1/2 md:-translate-y-1/2 z-20">
                                    <div class="neon-box bg-slate-800 w-64 p-4 rounded-xl text-center cursor-pointer hover:border-cyan-400 group relative">
                                        <div class="text-cyan-400 mb-2"><i class="fas fa-video text-3xl group-hover:scale-110 transition-transform"></i></div>
                                        <span class="text-lg font-bold text-white block font-teko tracking-wide">DJI O3 Air Unit</span>
                                        <span class="text-[10px] text-slate-400 uppercase tracking-wider bg-slate-900/50 px-2 py-0.5 rounded">Video HD System</span>
                                    </div>
                                </div>
            
                                <div class="relative md:absolute md:left-1/2 md:top-1/2 md:transform md:-translate-x-1/2 md:-translate-y-1/2 z-20">
                                    <div class="neon-box bg-slate-900 w-72 h-52 rounded-xl flex flex-col items-center justify-center relative border-slate-500 hover:border-red-500 group">
                                        <div class="absolute inset-0 bg-red-500/10 blur-2xl rounded-xl -z-10 group-hover:bg-red-500/20 transition-all opacity-0 group-hover:opacity-100"></div>
                                        <i class="fas fa-microchip text-6xl mb-3 text-white group-hover:text-red-500 transition-colors duration-300 drop-shadow-[0_0_10px_rgba(255,255,255,0.3)]"></i>
                                        <span class="font-teko text-4xl text-white tracking-wide">Flight Controller</span>
                                        <span class="text-xs text-slate-400 font-mono border border-slate-600 bg-slate-800 px-3 py-1 rounded mt-2">SpeedyBee F405 V3</span>
                                    </div>
                                </div>
                                
                                <div class="relative md:absolute md:top-[85%] md:left-1/2 md:transform md:-translate-x-1/2 md:-translate-y-1/2 z-20">
                                    <div class="neon-box bg-slate-800 w-64 p-4 rounded-xl text-center cursor-pointer hover:border-yellow-400 group relative">
                                        <div class="text-yellow-400 mb-2"><i class="fas fa-bolt text-3xl group-hover:scale-110 transition-transform"></i></div>
                                        <span class="text-lg font-bold text-white block font-teko tracking-wide">ESC 55A 4-in-1</span>
                                        <span class="text-[10px] text-slate-400 uppercase tracking-wider bg-slate-900/50 px-2 py-0.5 rounded">Power (6S LiPo)</span>
                                    </div>
                                </div>
                                
                                <div class="flex flex-wrap md:contents gap-4 w-full justify-center relative">
                                    <div class="relative md:absolute md:left-[15%] md:top-1/2 md:transform md:-translate-x-1/2 md:-translate-y-1/2 z-20">
                                        <div class="neon-box bg-slate-800 w-40 p-4 rounded-xl text-center cursor-pointer hover:border-blue-500 group">
                                            <div class="text-blue-500 mb-2"><i class="fas fa-wifi text-3xl group-hover:scale-110 transition-transform"></i></div>
                                            <span class="text-lg font-bold text-white block font-teko">ELRS RX</span>
                                            <span class="text-[10px] text-slate-400 uppercase tracking-wider">2.4GHz</span>
                                        </div>
                                    </div>
            
                                    <div class="relative md:absolute md:left-[85%] md:top-1/2 md:transform md:-translate-x-1/2 md:-translate-y-1/2 z-20">
                                        <div class="neon-box bg-slate-800 w-40 p-4 rounded-xl text-center cursor-pointer hover:border-green-500 group">
                                            <div class="text-green-500 mb-2"><i class="fas fa-satellite text-3xl group-hover:scale-110 transition-transform"></i></div>
                                            <span class="text-lg font-bold text-white block font-teko">GPS M10</span>
                                            <span class="text-[10px] text-slate-400 uppercase tracking-wider">Rescate</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- MODAL 4: FOROS -->
    <div id="modal-foros" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-slate-50 dark:bg-slate-900 w-full max-w-4xl rounded-2xl relative overflow-hidden flex flex-col shadow-2xl border border-slate-200 dark:border-slate-700">
             <!-- Header -->
             <div class="p-6 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center">
                <h2 class="text-3xl font-bold font-teko dark:text-white"><i class="fab fa-telegram text-telegram mr-2"></i> Foros Telegram</h2>
                <button onclick="closeSectionModal('modal-foros')" class="text-slate-400 hover:text-red-500 transition"><i class="fas fa-times text-2xl"></i></button>
            </div>
            <!-- Content -->
            <div class="p-10">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <a href="https://t.me/s/grupodronesgeneral" target="_blank" class="bg-white dark:bg-dark-card p-6 rounded-xl shadow flex items-center gap-4 hover:scale-105 transition border border-slate-100 dark:border-slate-700">
                        <div class="w-12 h-12 bg-telegram/10 rounded-full flex items-center justify-center text-telegram text-2xl"><i class="fas fa-comments"></i></div>
                        <div><h3 class="font-bold dark:text-white">General</h3><p class="text-xs text-slate-500">Chat diario</p></div>
                    </a>
                    <a href="https://t.me/s/droneofertas" target="_blank" class="bg-white dark:bg-dark-card p-6 rounded-xl shadow flex items-center gap-4 hover:scale-105 transition border border-slate-100 dark:border-slate-700">
                        <div class="w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center text-green-600 text-2xl"><i class="fas fa-shopping-cart"></i></div>
                        <div><h3 class="font-bold dark:text-white">Compra/Venta</h3><p class="text-xs text-slate-500">Mercadillo</p></div>
                    </a>
                    <a href="#" class="bg-white dark:bg-dark-card p-6 rounded-xl shadow flex items-center gap-4 hover:scale-105 transition border border-slate-100 dark:border-slate-700">
                        <div class="w-12 h-12 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center text-orange-600 text-2xl"><i class="fas fa-tools"></i></div>
                        <div><h3 class="font-bold dark:text-white">Taller</h3><p class="text-xs text-slate-500">Ayuda técnica</p></div>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals Standard (Contacto) -->
    <div id="contact-modal" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-white dark:bg-slate-800 rounded-lg max-w-md w-full p-6 relative border border-slate-700 shadow-2xl">
            <button onclick="document.getElementById('contact-modal').classList.add('hidden')" class="absolute top-4 right-4 text-slate-400 hover:text-white"><i class="fas fa-times"></i></button>
            <h3 class="text-2xl font-teko text-slate-900 dark:text-white mb-2">Contactar</h3>
            <p class="text-sm text-slate-500 mb-6">Interesado en: <strong id="contact-subject" class="text-red-500">Servicio</strong></p>
            <form onsubmit="event.preventDefault(); showToast('Enviado', 'success'); document.getElementById('contact-modal').classList.add('hidden');" class="space-y-4">
                <input type="email" placeholder="Tu Email" required class="w-full p-3 rounded bg-slate-100 dark:bg-slate-700 text-white border-none">
                <textarea rows="3" placeholder="Mensaje" required class="w-full p-3 rounded bg-slate-100 dark:bg-slate-700 text-white border-none"></textarea>
                <button type="submit" class="w-full bg-red-600 text-white py-3 rounded font-bold">Enviar</button>
            </form>
        </div>
    </div>
    
    <div id="admin-modal" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-white dark:bg-slate-800 rounded-lg max-w-lg w-full p-6 relative border border-slate-700">
            <button onclick="toggleAdminPanel()" class="absolute top-4 right-4 text-slate-400 hover:text-white"><i class="fas fa-times"></i></button>
            <div id="login-section">
                <h3 class="text-xl font-teko text-white mb-4">Login</h3>
                <form id="login-form" class="space-y-4">
                    <input type="email" id="login-email" placeholder="Email" class="w-full p-2 bg-slate-700 text-white rounded">
                    <input type="password" id="login-password" placeholder="Pass" class="w-full p-2 bg-slate-700 text-white rounded">
                    <button type="submit" class="w-full bg-red-600 text-white py-2 rounded">Entrar</button>
                </form>
            </div>
            <div id="editor-section" class="hidden">
                <h3 class="text-xl font-teko text-white mb-4">Editor</h3>
                <button onclick="logout()" class="text-red-400 text-xs mb-4">Salir</button>
                <form id="post-form" class="space-y-4">
                    <input type="text" id="post-title" placeholder="Título" class="w-full p-2 bg-slate-700 text-white rounded">
                    <input type="text" id="post-author" placeholder="Autor" class="w-full p-2 bg-slate-700 text-white rounded">
                    <input type="text" id="post-category" placeholder="Categoría" class="w-full p-2 bg-slate-700 text-white rounded">
                    <div id="drop-zone" class="border-2 border-dashed border-slate-600 p-4 text-center text-slate-400 cursor-pointer" onclick="document.getElementById('file-input').click()">Click o Pegar Imagen</div>
                    <input type="file" id="file-input" class="hidden" accept="image/*">
                    <input type="hidden" id="post-image-base64">
                    <img id="image-preview" class="hidden h-20 mx-auto object-cover rounded">
                    <textarea id="post-content" placeholder="Contenido..." class="w-full p-2 bg-slate-700 text-white rounded"></textarea>
                    <button type="submit" class="w-full bg-green-600 text-white py-2 rounded">Publicar</button>
                </form>
            </div>
        </div>
    </div>

    <div id="read-modal" class="fixed inset-0 z-[60] hidden modal-overlay overflow-y-auto">
         <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white dark:bg-slate-900 w-full max-w-3xl rounded-xl relative">
                <button onclick="closeReadModal()" class="absolute top-4 right-4 bg-black/50 text-white w-8 h-8 rounded-full z-10"><i class="fas fa-times"></i></button>
                <img id="read-post-image" class="w-full h-64 object-cover rounded-t-xl">
                <div class="p-8">
                    <h2 id="read-post-title" class="text-3xl font-bold dark:text-white font-teko mb-2"></h2>
                    <p class="text-sm text-slate-500 mb-6">Por <span id="read-post-author"></span> • <span id="read-post-date"></span></p>
                    <div id="read-post-content" class="prose dark:prose-invert"></div>
                </div>
            </div>
         </div>
    </div>
    
    <div id="legal-modal" class="fixed inset-0 z-[100] hidden modal-overlay flex items-center justify-center p-4">
        <div class="bg-white dark:bg-slate-800 rounded p-8 max-w-lg relative">
            <button onclick="document.getElementById('legal-modal').classList.add('hidden')" class="absolute top-4 right-4 text-slate-400"><i class="fas fa-times"></i></button>
            <h2 id="legal-title" class="text-xl font-bold dark:text-white mb-4"></h2>
            <div id="legal-content" class="text-sm dark:text-slate-300"></div>
        </div>
    </div>

    <footer class="bg-slate-900 text-slate-400 py-12 border-t-4 border-red-600">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <span class="font-teko text-4xl text-white">FPV <span class="text-red-600">DRONES</span></span>
            <div class="mt-4 flex justify-center gap-4 text-sm">
                <button onclick="openLegalModal('legal')">Aviso Legal</button>
                <button onclick="openLegalModal('privacy')">Privacidad</button>
                <button onclick="openLegalModal('cookies')">Cookies</button>
            </div>
            <div class="mt-8 text-xs">&copy; 2026 FPV-Drones.</div>
        </div>
    </footer>

    <!-- Logic -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, deleteDoc, updateDoc, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // CONFIG
        let firebaseConfig;
        let appId = 'default-app-id';
        if (window.location.hostname === 'localhost' || window.location.hostname.includes('127.0.0.1')) {
             if (typeof __firebase_config !== 'undefined') {
                 firebaseConfig = JSON.parse(__firebase_config);
                 appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
             }
        } 
        if (!firebaseConfig) {
            firebaseConfig = {
                apiKey: "AIzaSyDnaFkYwdNNInlwDcQT7Kjg2qZ2w08YOMU", 
                authDomain: "web-fpv-competicion.firebaseapp.com",
                projectId: "web-fpv-competicion",
                storageBucket: "web-fpv-competicion.firebasestorage.app",
                messagingSenderId: "736830142498",
                appId: "1:736830142498:web:4e967f2e50db6f3771f27b"
            };
        }

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        let currentUser = null;
        let postsCache = {};
        let editingPostId = null;

        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            const loginSec = document.getElementById('login-section');
            const editSec = document.getElementById('editor-section');
            const adminControls = document.getElementById('admin-controls');
            
            if(user) {
                if(loginSec) loginSec.classList.add('hidden');
                if(editSec) editSec.classList.remove('hidden');
                if(adminControls) adminControls.classList.remove('hidden');
                showToast(`Hola de nuevo`, 'success');
            } else {
                if(loginSec) loginSec.classList.remove('hidden');
                if(editSec) editSec.classList.add('hidden');
                if(adminControls) adminControls.classList.add('hidden');
            }
            renderBlogPosts();
        });
        
        const collectionPath = (typeof __app_id !== 'undefined' && (window.location.hostname === 'localhost' || window.location.hostname.includes('127.0.0.1')))
                ? collection(db, 'artifacts', appId, 'public', 'data', 'blog_posts')
                : collection(db, 'blog_posts');
        
        const q = query(collectionPath);
        onSnapshot(q, (snapshot) => {
            postsCache = {};
            snapshot.forEach(doc => { postsCache[doc.id] = doc.data(); });
            renderBlogPosts();
        });

        function renderBlogPosts() {
            const container = document.getElementById('blog-posts-container');
            if(!container) return;
            container.innerHTML = '';
            
            const posts = Object.entries(postsCache).map(([id, data]) => ({id, ...data}));
            
            if (posts.length === 0) {
                container.innerHTML = '<p class="text-center col-span-3 text-slate-500">No hay noticias.</p>';
                return;
            }

            posts.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));

            posts.forEach(post => {
                const div = document.createElement('div');
                div.className = "bg-white dark:bg-slate-800 rounded-lg shadow overflow-hidden hover:shadow-lg transition cursor-pointer flex flex-col";
                div.onclick = (e) => {
                      if(e.target.closest('button')) return;
                      openReadModal(post);
                };
                div.innerHTML = `
                    <img src="${post.image || 'https://via.placeholder.com/400'}" class="h-32 w-full object-cover">
                    <div class="p-4 flex-grow">
                        <span class="text-[10px] font-bold text-red-600 uppercase tracking-widest">${post.category || 'Blog'}</span>
                        <h3 class="font-bold text-md dark:text-white leading-tight mt-1 line-clamp-2">${post.title}</h3>
                    </div>
                    ${currentUser ? `
                    <div class="p-4 pt-0 flex gap-2">
                        <button onclick="window.editPost('${post.id}')" class="text-blue-500 text-xs">Editar</button>
                        <button onclick="window.deletePost('${post.id}')" class="text-red-500 text-xs">Borrar</button>
                    </div>` : ''}
                `;
                container.appendChild(div);
            });
        }
        
        window.login = async (e) => {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-password').value;
            try { await signInWithEmailAndPassword(auth, email, pass); } catch(e) { showToast(e.message, 'error'); }
        };
        window.logout = () => signOut(auth);
        
        window.createPost = async (e) => {
            e.preventDefault();
            const data = {
                title: document.getElementById('post-title').value,
                author: document.getElementById('post-author').value,
                category: document.getElementById('post-category').value,
                content: document.getElementById('post-content').value,
                image: document.getElementById('post-image-base64').value,
                createdAt: new Date().toISOString()
            };
            try {
                if(editingPostId) await updateDoc(doc(collectionPath, editingPostId), data);
                else await addDoc(collectionPath, data);
                showToast('Guardado', 'success');
                toggleAdminPanel();
            } catch(e) { showToast(e.message, 'error'); }
        };
        
        window.editPost = (id) => {
            const p = postsCache[id];
            if(!p) return;
            document.getElementById('post-title').value = p.title;
            document.getElementById('post-content').value = p.content;
            document.getElementById('post-image-base64').value = p.image;
            document.getElementById('image-preview').src = p.image;
            document.getElementById('image-preview').classList.remove('hidden');
            editingPostId = id;
            toggleAdminPanel();
        };
        
        window.deletePost = async (id) => {
            if(confirm('¿Borrar?')) await deleteDoc(doc(collectionPath, id));
        };
        
        document.getElementById('login-form').addEventListener('submit', window.login);
        document.getElementById('post-form').addEventListener('submit', window.createPost);
        
        const handleFile = (file) => {
            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('post-image-base64').value = e.target.result;
                document.getElementById('image-preview').src = e.target.result;
                document.getElementById('image-preview').classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        };
        
        document.getElementById('file-input').addEventListener('change', e => handleFile(e.target.files[0]));
        document.addEventListener('paste', e => {
            if(document.getElementById('admin-modal').classList.contains('hidden')) return;
            const items = e.clipboardData.items;
            for(let i=0; i<items.length; i++) {
                if(items[i].kind === 'file') handleFile(items[i].getAsFile());
            }
        });
        
        const dropZone = document.getElementById('drop-zone');
        if(dropZone){
             dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.classList.add('border-red-500'); });
             dropZone.addEventListener('dragleave', (e) => { e.preventDefault(); dropZone.classList.remove('border-red-500'); });
             dropZone.addEventListener('drop', (e) => { 
                e.preventDefault(); 
                dropZone.classList.remove('border-red-500');
                if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
             });
        }

        window.toggleAdminPanel = () => {
            const m = document.getElementById('admin-modal');
            m.classList.toggle('hidden');
            if(m.classList.contains('hidden')) {
                document.getElementById('post-form').reset();
                editingPostId = null;
                document.getElementById('image-preview').classList.add('hidden');
            }
        };
        
        window.openReadModal = (post) => {
            document.getElementById('read-post-title').innerText = post.title;
            document.getElementById('read-post-image').src = post.image;
            document.getElementById('read-post-author').innerText = post.author || 'Admin';
            document.getElementById('read-post-date').innerText = new Date(post.createdAt).toLocaleDateString();
            document.getElementById('read-post-content').innerHTML = post.content.replace(/\n/g, '<br>');
            document.getElementById('read-modal').classList.remove('hidden');
        };
        
        window.closeReadModal = () => document.getElementById('read-modal').classList.add('hidden');
        
        window.openSectionModal = (id) => document.getElementById(id).classList.remove('hidden');
        window.closeSectionModal = (id) => document.getElementById(id).classList.add('hidden');
    </script>
    
    <script>
        // UI Logic
        function switchTab(phaseId, btn) {
            const container = btn.closest('.tab-container'); 
            if(!container) return;
            container.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
            const target = container.querySelector('#' + phaseId);
            if(target) target.classList.remove('hidden');
            
            btn.parentElement.querySelectorAll('button').forEach(b => {
                 b.classList.remove('bg-slate-900', 'text-white', 'dark:bg-red-600');
                 b.classList.add('text-slate-500');
            });
            btn.classList.remove('text-slate-500');
            btn.classList.add('bg-slate-900', 'text-white', 'dark:bg-red-600');
        }

        const gearData = {
            pro: [
                { name: "DJI Goggles 2", type: "Gafas", desc: "Digital HD", icon: "fa-vr-cardboard" },
                { name: "Radiomaster Boxer", type: "Emisora", desc: "ELRS 1W", icon: "fa-gamepad" },
                { name: "AOS 5 V5", type: "Drone", desc: "Freestyle", icon: "fa-paper-plane" },
                { name: "Torvol Pitstop", type: "Mochila", desc: "Pro", icon: "fa-suitcase" }
            ],
            beginner: [
                { name: "Emax Tinyhawk III", type: "Kit RTF", desc: "Todo en uno", icon: "fa-box-open" },
                { name: "Radiomaster Pocket", type: "Emisora", desc: "Económica", icon: "fa-gamepad" },
                { name: "Skyzone Cobra X", type: "Gafas", desc: "Analógicas", icon: "fa-vr-cardboard" },
                { name: "Velocidrone", type: "Simulador", desc: "Software", icon: "fa-desktop" }
            ]
        };

        function toggleGear(mode) {
            const container = document.getElementById('gear-grid');
            if(!container) return;
            
            const btnPro = document.getElementById('btn-gear-pro');
            const btnBeg = document.getElementById('btn-gear-beginner');

            if(mode === 'pro') {
                if(btnPro) btnPro.className = "px-3 py-1 text-xs font-bold bg-white shadow rounded text-slate-900 transition";
                if(btnBeg) btnBeg.className = "px-3 py-1 text-xs font-bold text-slate-500 hover:text-slate-900 transition";
            } else {
                if(btnBeg) btnBeg.className = "px-3 py-1 text-xs font-bold bg-white shadow rounded text-slate-900 transition";
                if(btnPro) btnPro.className = "px-3 py-1 text-xs font-bold text-slate-500 hover:text-slate-900 transition";
            }

            container.innerHTML = '';
            gearData[mode].forEach(item => {
                const div = document.createElement('div');
                div.className = "bg-slate-50 dark:bg-slate-900 p-3 rounded-lg border border-slate-100 dark:border-slate-700 flex flex-col items-center text-center";
                div.innerHTML = `
                    <i class="fas ${item.icon} text-2xl text-slate-700 dark:text-slate-400 mb-2"></i>
                    <h4 class="font-bold dark:text-white uppercase font-teko leading-none">${item.name}</h4>
                    <span class="text-[10px] text-slate-500">${item.desc}</span>
                `;
                container.appendChild(div);
            });
        }

        function calculateFlightTime() {
             const mah = document.getElementById('calc-mah').value;
             let min = Math.floor((mah * 0.8) / 300); 
             document.getElementById('calc-result').innerText = min + ":30 min";
        }
        
        function calculateLipoCharge() {
            const mah = document.getElementById('lipo-mah').value;
            const count = document.getElementById('lipo-count').value;
            const c = document.getElementById('lipo-c').value;
            const amps = (mah * count / 1000) * c;
            document.getElementById('lipo-result').innerText = amps.toFixed(1) + " A";
        }
        
        function loadYoutubeVideo(el) {
             const id = el.getAttribute('data-video-id');
             el.innerHTML = `<iframe src="https://www.youtube-nocookie.com/embed/${id}?autoplay=1" class="absolute inset-0 w-full h-full" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
        }
        
        async function updateLatestChannelVideos() {
            const container = document.getElementById('latest-videos-grid');
            if(!container) return;
            try {
                const res = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=https://www.youtube.com/feeds/videos.xml?channel_id=UCMf2ohoBrB1pgErsMa21SKg`);
                const data = await res.json();
                if(data.items) {
                    container.innerHTML = '';
                    data.items.slice(0,3).forEach(v => {
                        const vidId = v.guid.split(':')[2];
                        const div = document.createElement('a');
                        div.href = v.link;
                        div.target = "_blank";
                        div.className = "group block";
                        div.innerHTML = `
                            <div class="relative overflow-hidden rounded-lg shadow-lg mb-2">
                                <img src="https://img.youtube.com/vi/${vidId}/maxresdefault.jpg" class="w-full aspect-video object-cover group-hover:scale-105 transition duration-500">
                                <div class="absolute inset-0 flex items-center justify-center bg-black/20 group-hover:bg-transparent transition"><i class="fab fa-youtube text-4xl text-white"></i></div>
                            </div>
                            <h4 class="font-bold dark:text-white line-clamp-2 group-hover:text-red-500 transition">${v.title}</h4>
                        `;
                        container.appendChild(div);
                    });
                }
            } catch(e) { console.log(e); }
        }

        async function updateLatestVideo() {
            const channelId = 'UCMf2ohoBrB1pgErsMa21SKg'; 
            try {
                const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=https://www.youtube.com/feeds/videos.xml?channel_id=${channelId}`);
                const data = await response.json();
                if (data.items && data.items.length > 0) {
                    const item = data.items[0];
                    const latestVideoId = item.guid.split(':')[2];
                    const thumb = item.thumbnail;
                    
                    const placeholder = document.getElementById('video-placeholder');
                    if (placeholder && latestVideoId) {
                        placeholder.setAttribute('data-video-id', latestVideoId);
                        const maxRes = `https://img.youtube.com/vi/${latestVideoId}/maxresdefault.jpg`;
                        const img = new Image();
                        img.onload = () => { placeholder.style.backgroundImage = `url('${maxRes}')`; };
                        img.onerror = () => { placeholder.style.backgroundImage = `url('${thumb}')`; };
                        img.src = maxRes;
                    }
                }
            } catch (error) {
                console.error('Error actualizando vídeo de portada:', error);
            }
        }

        function showToast(msg, type) {
            const d = document.createElement('div');
            d.className = `toast ${type}`;
            d.innerText = msg;
            document.getElementById('toast-container').appendChild(d);
            setTimeout(() => d.remove(), 3000);
        }
        
        function scrollToSection(id) {
            const el = document.getElementById(id);
            if (el) el.scrollIntoView({behavior: 'smooth'});
        }
        
        function openLegalModal(type) {
            const t = document.getElementById('legal-title');
            const c = document.getElementById('legal-content');
            if(type === 'cookies') { t.innerText = 'Cookies'; c.innerHTML = '<p>Texto legal de cookies...</p>'; }
            if(type === 'privacy') { t.innerText = 'Privacidad'; c.innerHTML = '<p>Texto legal de privacidad...</p>'; }
            if(type === 'legal') { t.innerText = 'Aviso Legal'; c.innerHTML = '<p>Texto legal...</p>'; }
            document.getElementById('legal-modal').classList.remove('hidden');
        }

        window.toggleFaq = function(button) {
             const content = button.nextElementSibling;
             const icon = button.querySelector('i');
             content.classList.toggle('hidden');
             icon.classList.toggle('rotate-180');
        }

        window.addEventListener('DOMContentLoaded', () => {
            toggleGear('pro');
            updateLatestChannelVideos();
            updateLatestVideo();
            
            const toggleDesktop = document.getElementById('theme-toggle-desktop');
            if (toggleDesktop) toggleDesktop.onclick = () => document.documentElement.classList.toggle('dark');
            
            const toggleMobile = document.getElementById('theme-toggle-mobile');
            if (toggleMobile) toggleMobile.onclick = () => document.documentElement.classList.toggle('dark');
            
            document.querySelectorAll('.mobile-link').forEach(link => {
                link.addEventListener('click', () => {
                    document.getElementById('mobile-menu').classList.add('hidden');
                });
            });
            
            const menuBtn = document.getElementById('mobile-menu-btn');
            if (menuBtn) {
                menuBtn.addEventListener('click', () => {
                    document.getElementById('mobile-menu').classList.toggle('hidden');
                });
            }

            const tbody = document.getElementById('couponTableBody');
            const coupons = [
                { store: "Banggood", prod: "RC General", discount: "10%", code: "FPV10" },
                { store: "BetaFPV", prod: "Meteor", discount: "5%", code: "METEOR5" },
                { store: "Radiomaster", prod: "Boxer", discount: "12%", code: "RMBOX" }
            ];
            if(tbody) {
                coupons.forEach(c => {
                    tbody.innerHTML += `
                        <tr class="hover:bg-slate-50 dark:hover:bg-slate-700/50">
                            <td class="px-6 py-4 font-bold dark:text-white">${c.store}</td>
                            <td class="px-6 py-4 dark:text-slate-300">${c.prod}</td>
                            <td class="px-6 py-4 text-red-500 font-bold">${c.discount}</td>
                            <td class="px-6 py-4 text-right">
                                <button onclick="copyToClipboard('${c.code}')" class="bg-slate-100 dark:bg-slate-800 border border-slate-300 dark:border-slate-600 px-3 py-1 rounded text-xs font-mono hover:bg-red-50 dark:hover:bg-red-900/20 hover:text-red-500 transition">
                                    ${c.code} <i class="fas fa-copy ml-1"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                });
            }

            window.copyToClipboard = function(text) {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    showToast('Copiado', 'success');
                } catch (err) {
                    showToast('Error', 'error');
                }
                document.body.removeChild(textArea);
            };
        });
        
        window.openSectionModal = (id) => document.getElementById(id).classList.remove('hidden');
        window.closeSectionModal = (id) => document.getElementById(id).classList.add('hidden');
    </script>
</body>
</html>